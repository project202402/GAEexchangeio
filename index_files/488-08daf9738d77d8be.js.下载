"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[488],{45203:function(e,t,n){var a,r,o=n(2784),i=["title","titleId"];function s(){return(s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}t.Z=function(e){var t=e.title,n=e.titleId,l=function(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}(e,i);return o.createElement("svg",s({width:28,height:28,fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},l),t?o.createElement("title",{id:n},t):null,a||(a=o.createElement("path",{d:"m16 18-4-4 4-4",stroke:"#96A2B4",strokeWidth:1.333,strokeLinecap:"round",strokeLinejoin:"round"})),r||(r=o.createElement("rect",{x:.5,y:.5,width:27,height:27,rx:3.5,stroke:"currentColor"})))}},99585:function(e,t,n){var a,r=n(2784),o=["title","titleId"];function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}t.Z=function(e){var t=e.title,n=e.titleId,s=function(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}(e,o);return r.createElement("svg",i({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-labelledby":n},s),t?r.createElement("title",{id:n},t):null,a||(a=r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.5 21 3 16.5m0 0L7.5 12M3 16.5h13.5m0-13.5L21 7.5m0 0L16.5 12M21 7.5H7.5"})))}},48278:function(e,t,n){var a=n(52322),r=n(72779),o=n.n(r),i=n(84986),s=n(95376),l=n(84604),u=n(81227),c=n(55847),d=n(75269),h=n(46262),p=n(22510),f=n(12550),w=n(66743),m=n(2784);let g=/^mm[0-9]+(_[0-9]+)?$/i;t.Z=(0,w.Z)(function(e){let{isOpen:t,onRequestClose:n,pageTheme:r}=e,w=(0,c.Gc)(),{liquiditySources:v,selectedLiquiditySources:x,setSelectedLiquiditySources:y}=(0,d.wA)(),[k,b]=(0,m.useState)(()=>{let e=new Set(x);return x?v.filter(t=>e.has(t)):v}),T=0===k.length,{gradients:q,onScroll:E,scrollContainerRef:Z}=(0,f.Z)("small"===w?"var(--gray_0)":"var(--gray_0_25)");return(0,m.useEffect)(E,[v,E]),(0,a.jsx)(s.Z,{isOpen:t,onRequestClose:n,pageTheme:r,children:(0,a.jsxs)("form",{className:"flex w-full flex-auto flex-col items-stretch gap-6",onSubmit:e=>e.preventDefault(),children:[(0,a.jsx)("div",{className:"flex-none",children:(0,a.jsx)(s.Z.Header,{title:"Trade Settings",showCloseButton:!1,closeButtonType:"exchange-v2"===r?"square":void 0})}),(0,a.jsx)("div",{className:"flex-auto",children:(0,a.jsx)(l.d,{children:(0,a.jsxs)("div",{className:"flex flex-col items-stretch gap-6",children:[(0,a.jsxs)("div",{className:"flex gap-2 text-xs text-gray-4",children:["Liquidity Sources",(0,a.jsx)(u.B,{children:"Customize trading to specific market makers. Disabling liquidity sources may result in fewer or worse quotes for your trade."})]}),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"relative flex-auto",children:[(0,a.jsx)("div",{className:"flex flex-col items-stretch gap-6 overflow-auto lg:max-h-[300px]",ref:Z,onScroll:E,children:v.map(e=>(0,a.jsxs)("label",{className:"flex gap-2",children:[(0,a.jsx)(h.Z,{toggled:k.includes(e),onToggle:t=>{t?b(t=>[...t,e]):(b(t=>t.filter(t=>t!==e)),(0,p.XV)(p.cC.EXCHANGE.CHANGE_LIQUIDITY_SOURCE_CLICK))}}),(0,a.jsx)("span",{className:"text-gray-10",children:e.match(g)?e.toUpperCase():e})]},"source-".concat(e)))}),q]}),T&&(0,a.jsx)("div",{className:"text-xs text-red-7",children:"Trades require at least one liquidity source to be selected."})]})]})})}),(0,a.jsx)("div",{className:"flex gap-4",children:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)(i.Z,{style:"secondary",onClick:n,size:"exchange-v2"===r?"unset":void 0,className:o()("exchange-v2"===r&&"rounded p-[12px] text-[14px] leading-[16px]"),children:"Cancel"})}),(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)(i.Z,{onClick:()=>{let e=new Set(k);v.every(t=>e.has(t))?y(void 0):y([...k].sort()),n()},type:"submit",disabled:T,size:"exchange-v2"===r?"unset":void 0,className:o()("exchange-v2"===r&&"rounded p-[12px] text-[14px] leading-[16px]"),children:"Save"})})]})})]})})})},70933:function(e,t,n){n.d(t,{Z:function(){return s}});var a=n(52322),r=n(72779),o=n.n(r),i=n(53952);function s(e){let{type:t="long",width:n,height:r,children:s=null,loading:l=!0}=e,{theme:u}=(0,i.F)();return l?(0,a.jsx)("div",{className:o()({"h-4 w-[90px] rounded-lg":"long"===t,"h-6 w-6 rounded-full":"round"===t,"skeleton-light":"light"===u,"skeleton-dark":"dark"===u}),style:{width:n,height:r}}):(0,a.jsx)(a.Fragment,{children:s})}},37614:function(e,t,n){n.d(t,{Z:function(){return S}});var a=n(52322),r=n(4466),o=n(72779),i=n.n(o),s=n(12684),l=n(19783),u=n(4236),c=n(49524),d=n(8225),h=n(40770),p=n(50861),f=n(78986),w=n(70977),m=n(75763),g=n(7336),v=n(92193),x=n(26461),y=n(89397),k=n(52420),b=n(94180),T=n(2784),q=n(22510),E=n(94630),Z=n(30410),C=n(50480),j=n(88943),A=n(27502),N=n(16067);function S(e){var t,n,o,S;let{onShowAddAllowance:I,onShowIncreaseAllowance:B,onShowRevokeAllowance:R,onShowConnectWallet:F,showErrorsInButton:O,buttonProps:Q,inactiveText:D="Enter Amount",disabled:P,onClickBuyIfInsufficientBalance:U}=e,[L,M]=(0,T.useState)(!1),G=(0,c.W)(),_=(0,f.P)(),{selectedQuest:K,questTokenBalances:H}=(0,w.V)(),W=null==K?void 0:K.depositTokens,V=!!K,{baseToken:z,baseAmount:J,quoteToken:X,quoteAmount:Y}=(0,d.AK)(),{currentWallet:$,connectionState:ee}=(0,u.OZ)(),{error:et}=(0,x.Os)(),{balances:en}=(0,l.ln)(),ea=(0,h.F)(),{allowances:er}=(0,s.YT)(),{barterTradingPairContract:eo,getPairApis:ei}=(0,p.Zd)(),es=(0,T.useMemo)(()=>null!==(o=$&&"evm"===$.chain.chainType&&ea.result?ea.result.apiType===j.I.BARTER?null==eo?void 0:eo[$.chain.chainId]:r.contractAddressesByNetwork.router[A.Wh[$.wallet.hashflow.contracts.chainId]].address:void 0)&&void 0!==o?o:"",[$,ea.result,eo]),{getNativeTokenChain:el,getWrappedNativeTokenChain:eu}=(0,v.rU)();!function(){let[e,t]=(0,T.useState)(null),n=(0,h.F)(),a=(0,m.C)();(0,b.Y)((0,T.useCallback)(()=>{if(n.result&&"wrap-unwrap-token"!==n.result.type&&n.result.hashflowQuote){let{expires:e}=n.result.hashflowQuote,r=e-Math.floor(a().valueOf()/1e3),o=r+y.g;t(o)}else t(null)},[n,a]),1e3)}();let ec=$?el($.chain):void 0,ed=$?eu($.chain):void 0,eh=ec&&ed&&(0,k.m)(z,X,ec,ed),ep="Trade";eh&&(ep=(0,N.RZ)(z,ec)?"Wrap ".concat(z.name):"Unwrap ".concat(z.name));let ef=(0,m.C)(),ew=(0,y.Z)(ef(),ea,!0),em=ec&&!V&&!eh&&(0,E.CH)(er,es,z,J,ec);return(0,T.useEffect)(()=>{if(!$)return;let e=async()=>{(0,E.k7)($.wallet,z).then(()=>{M(!1)}).catch(()=>{M(!0)})};em&&e()},[z,em,$]),(0,a.jsx)("div",{className:i()({"opacity-80":(null===(t=G.state)||void 0===t?void 0:t.status)==="pending"||ew},"truncate"),children:(0,a.jsxs)(g.Z,{type:"submit",...Q||{},children:[(0,a.jsx)(g.Z.Condition,{testId:"connect-wallet-button",test:!$,onClick:()=>{F(),(0,q.XV)(q.cC.WALLET.EXCHANGE_BUTTON_CONNECT_CLICK)},children:"Connect Wallet"}),(0,a.jsx)(g.Z.Condition,{test:"disconnected"===ee&&et instanceof x.Uu,disabled:!0,children:"Unsupported Network"}),(0,a.jsx)(g.Z.Condition,{test:(null===(n=G.state)||void 0===n?void 0:n.status)==="pending",disabled:!0,children:"Submitting…"}),(0,a.jsx)(g.Z.Condition,{test:0===ei(z,X).length,disabled:!0,children:"Select Different Assets"}),(0,a.jsx)(g.Z.Condition,{test:J.isZero(),disabled:!0,children:D}),(0,a.jsx)(g.Z.Condition,{test:J.isGreaterThan(null!==(S=(V&&W?H:en)[V?(0,N.zS)((0,Z.$p)(z)):(0,N.Bf)(z)])&&void 0!==S?S:0),disabled:!U,onClick:U,children:U?"Buy ".concat(z.name):O?"Insufficient ".concat(z.name," Balance"):"Trade"}),(0,a.jsx)(g.Z.Condition,{test:ec&&!V&&!eh&&(0,E.JY)(er,es,z,ec),disabled:!0,children:"Trade"}),(0,a.jsx)(g.Z.Condition,{test:em&&L,onClick:()=>null==R?void 0:R(z),style:"transparent",children:"Revoke Allowance"}),(0,a.jsxs)(g.Z.Condition,{test:ec&&!V&&!eh&&(0,E.CH)(er,es,z,J,ec),onClick:()=>B(z),style:"transparent",children:["Increase ",z.name," allowance"]}),(0,a.jsxs)(g.Z.Condition,{test:ec&&!V&&!eh&&(0,E.Ok)(er,es,z,ec,["setting","increasing"]),disabled:!0,children:["Unlocking ",z.name,"…"]}),(0,a.jsxs)(g.Z.Condition,{test:ec&&!V&&!eh&&(0,E.Ok)(er,es,z,ec,"revoking"),disabled:!0,children:["Revoking ",z.name,"…"]}),(0,a.jsxs)(g.Z.Condition,{test:ec&&!V&&!eh&&(0,E.P5)(er,es,z,ec),onClick:()=>I(z),style:"transparent",children:["Unlock ",z.name]}),(0,a.jsx)(g.Z.Condition,{test:ew&&O,disabled:!0,children:"Fetching Quote…"}),(0,a.jsx)(g.Z.Condition,{test:J.isZero()||Y.isZero(),disabled:!0,children:D}),(0,a.jsx)(g.Z.Condition,{onClick:()=>{if(!$)throw Error("Cannot submit without a wallet");(0,C.v)($.chain),V?_.mutate():G.mutate()},children:ep})]})})}},49524:function(e,t,n){n.d(t,{W:function(){return N},Z:function(){return S}});var a=n(52322),r=n(45676),o=n(19783),i=n(4236),s=n(8225),l=n(40770),u=n(32653),c=n(75763),d=n(64601),h=n(83051),p=n(92193),f=n(136),w=n(92630),m=n(437),g=n(22650),v=n(38113),x=n(26533),y=n(27085),k=n(52420),b=n(49073),T=n(6797),q=n(12806),E=n(16067),Z=n(2784),C=n(60715);let[j,A]=(0,y.Z)(),N=A;function S(e){let t,{children:n}=e,{baseToken:y,quoteToken:A}=(0,s.AK)(),{currentWallet:N}=(0,i.OZ)(),{getNativeTokenChain:S,getWrappedNativeTokenChain:I}=(0,p.rU)(),B=N?S(N.chain):void 0,R=N?I(N.chain):void 0,F=function(){let e=(0,c.C)(),{currentWallet:t}=(0,i.OZ)(),{selectedGasPrice:n,isEip1559:a}=(0,u.J)(),{addTransactionHistoryEntry:m,updateTransactionHistoryEntry:x}=(0,f.h)(),{leaseProvider:y}=(0,d.R)(),{showToast:k}=(0,h.tF)(),q=(0,l.F)(),{balances:E,refetchBalances:j}=(0,o.ln)(),{setBaseAmount:A,setQuoteAmount:N}=(0,s.AK)(),{prices:S}=(0,w.L)(),{getNativeTokenChain:I,getWrappedNativeTokenChain:B}=(0,p.rU)(),R=t?I(t.chain):void 0,F=t?B(t.chain):void 0,{startTask:O}=(0,r.HJ)(),Q=(0,T.Z)([t]),[D,P]=(0,Z.useState)(),U=(0,r.GS)(D),L=(0,Z.useCallback)(async()=>{var r,o,i;if(t){if(!R||!F)throw Error("Invalid native/wrapped native token.")}else throw Error("Expected a wallet to be set.");if((null===(r=q.result)||void 0===r?void 0:r.type)!=="single-network-trade"||!(null===(o=q.result)||void 0===o?void 0:o.hashflowQuote))throw Error("Missing single-network quote.");let{arguments:{baseToken:s,quoteToken:l},hashflowQuote:u}=q.result,c=(null===(i=u.quoteData)||void 0===i?void 0:i.rfqType)===C.C.RFQM?O(g.d,(0,g.Z)({baseToken:s,quoteToken:l,wallet:t.wallet,addTransactionHistoryEntry:m,updateTransactionHistoryEntry:x,showToast:k,hashflowQuote:u,balances:E,nativeToken:R,wrappedNativeToken:F,abortSignal:Q.current.signal,usdPrices:S,refetchBalances:j,getServerDate:e})):O(v.aj,(0,v.ZP)({baseToken:s,quoteToken:l,wallet:t,leaseProvider:y,gasPriceOptions:(0,b.$A)(n,a),addTransactionHistoryEntry:m,updateTransactionHistoryEntry:x,showToast:k,hashflowQuote:u,balances:E,nativeToken:R,wrappedNativeToken:F,abortSignal:Q.current.signal,usdPrices:S,refetchBalances:j,getServerDate:e}));q.reset(),A("",s),N("",l),P(c)},[t,y,q,O,n,a,m,x,k,E,R,F,Q,A,N,S,j,e]),M=(0,Z.useCallback)(()=>P(void 0),[]);return(0,Z.useMemo)(()=>({mutate:L,state:U,reset:M}),[L,U,M])}(),O=function(){let e=(0,c.C)(),{currentWallet:t}=(0,i.OZ)(),{selectedGasPrice:n,isEip1559:a}=(0,u.J)(),{addTransactionHistoryEntry:g,updateTransactionHistoryEntry:v}=(0,f.h)(),{leaseProvider:x}=(0,d.R)(),{showToast:y}=(0,h.tF)(),k=(0,l.F)(),{balances:q,refetchBalances:E}=(0,o.ln)(),{setBaseAmount:C,setQuoteAmount:j}=(0,s.AK)(),{prices:A}=(0,w.L)(),{getNativeTokenChain:N}=(0,p.rU)(),S=t?N(t.chain):void 0,{startTask:I}=(0,r.HJ)(),B=(0,T.Z)([t]),[R,F]=(0,Z.useState)(),O=(0,r.GS)(R),Q=(0,Z.useCallback)(async()=>{var r,o;if(!t)throw Error("Expected a wallet to be set.");if((null===(r=k.result)||void 0===r?void 0:r.type)!=="cross-network-trade"||!(null===(o=k.result)||void 0===o?void 0:o.hashflowQuote))throw Error("Missing cross-network quote.");let{hashflowQuote:i,arguments:{baseToken:s,quoteToken:l}}=k.result,u=I(m.CF,(0,m.ZP)({baseToken:s,quoteToken:l,wallet:t,leaseProvider:x,gasPriceOptions:(0,b.$A)(n,a),addTransactionHistoryEntry:g,updateTransactionHistoryEntry:v,showToast:y,quote:k.result,balances:q,nativeToken:S,abortSignal:B.current.signal,crossChainGasFeeEstimate:i.crossChainGasFeeEstimate,gasEstimate:i.gasEstimate,gasFeeEstimate:i.gasFeeEstimate,usdPrices:A,refetchBalances:E,getServerDate:e}));k.reset(),C("",s),j("",l),F(u)},[t,x,k,I,n,a,g,v,y,q,S,B,C,j,A,E,e]),D=(0,Z.useCallback)(()=>F(void 0),[]);return(0,Z.useMemo)(()=>({mutate:Q,state:O,reset:D}),[Q,O,D])}(),Q=function(){let e=(0,c.C)(),{currentWallet:t}=(0,i.OZ)(),{selectedGasPrice:n,isEip1559:a}=(0,u.J)(),{addTransactionHistoryEntry:m,updateTransactionHistoryEntry:g}=(0,f.h)(),{leaseProvider:v}=(0,d.R)(),{setBaseAmount:y,setQuoteAmount:q}=(0,s.AK)(),C=(0,l.F)(),{showToast:j}=(0,h.tF)(),{balances:A,refetchBalances:N}=(0,o.ln)(),{getNativeTokenChain:S,getWrappedNativeTokenChain:I}=(0,p.rU)(),B=t?S(t.chain):void 0,R=t?I(t.chain):void 0,{prices:F}=(0,w.L)(),{startTask:O}=(0,r.HJ)(),Q=(0,T.Z)([t]),[D,P]=(0,Z.useState)(),U=(0,r.GS)(D),L=(0,Z.useCallback)(async()=>{var r;if(t){if(!B||!R)throw Error("Invalid native/wrapped native token.")}else throw Error("Expected a wallet to be set.");if((null===(r=C.result)||void 0===r?void 0:r.type)!=="wrap-unwrap-token")throw Error("Missing wrap/unwrap quote.");let{amount:o,gasEstimate:i,gasFeeEstimate:s,arguments:{baseToken:l,quoteToken:u}}=C.result;if(!(0,k.m)(l,u,B,R))throw Error("Wrapping requires valid token pair.");let[c,d]=(0,E.RZ)(l,B)?[l,u]:[u,l],h=O(x.Yo,(0,x.ZP)({direction:(0,E.RZ)(l,B)?"wrap":"unwrap",amount:o,unwrappedToken:c,wrappedToken:d,gasEstimate:i,gasFeeEstimate:s,wallet:t,leaseProvider:v,gasPriceOptions:(0,b.$A)(n,a),addTransactionHistoryEntry:m,updateTransactionHistoryEntry:g,showToast:j,balances:A,abortSignal:Q.current.signal,usdPrices:F,refetchBalances:N,getServerDate:e}));y("",l),q("",u),P(h)},[t,v,C.result,B,R,O,n,a,m,g,j,A,Q,y,q,F,N,e]),M=(0,Z.useCallback)(()=>P(void 0),[]);return(0,Z.useMemo)(()=>({mutate:L,state:U,reset:M}),[L,U,M])}();t=R&&B&&(0,k.m)(y,A,B,R)?Q:(0,k.b)(y,A)?O:F;let{reset:D}=t;return(0,q.Z)(()=>{D()},[null==N?void 0:N.chain,D]),(0,a.jsx)(j,{value:t,children:n})}},8225:function(e,t,n){n.d(t,{ZP:function(){return A},AK:function(){return j}});var a=n(52322),r=n(65500),o=n(72558),i=n(4236),s=n(75269),l=n(50861),u=n(32653),c=n(92193),d=n(92630),h=n(27085),p=n(5632),f=n(2784),w=n(5213),m=n(49073),g=n(5126),v=n(424),x=n(88943),y=n(48935),k=n(88727),b=n(27502),T=n(16067),q=n(81772),E=n(23716);y.xE;let[Z,C]=(0,h.Z)(),j=C;function A(e){let{children:t}=e,{currentWallet:n}=(0,i.OZ)();return(0,a.jsx)(N,{children:t},n?(0,b.WX)(n.chain):void 0)}function N(e){var t,n,h,y,b,C;let{children:j}=e,{currentWallet:A,pastSolanaWallets:N,pastEvmWallets:S}=(0,i.OZ)(),{knownTokens:I,getQuoteTokens:B,getPairApis:R}=(0,l.Zd)(),F=function(e){let{query:t}=(0,p.useRouter)(),[n,a]=("string"==typeof t.b?t.b:"").split("-"),[r,o]=("string"==typeof t.q?t.q:"").split("-"),i=t.r,s=(0,f.useMemo)(()=>{if("string"!=typeof a||"string"!=typeof n||"string"!=typeof o||"string"!=typeof r||"string"!=typeof i)return;let t=e.find(e=>e.name===a&&e.chain.chainId===Number(n)),s=e.find(e=>e.name===o&&e.chain.chainId===Number(r));return t&&s?{baseToken:t,quoteToken:s}:void 0},[a,n,o,r,i,e]);return s}(I),[O,Q]=(0,g.ZP)("trading-pairs"),D=(0,f.useRef)(null!=O?O:{}),{selectedLiquiditySources:P}=(0,s.wA)(),{getNativeTokenChain:U,getWrappedNativeTokenChain:L}=(0,c.rU)(),M=function(e){let t=(0,f.useRef)(!1),n=(0,f.useRef)();return t.current||(n.current=e(),t.current=!0),n}(()=>(function(e){let{getNativeTokenChain:t,getWrappedNativeTokenChain:n,chain:a,getPairApis:r,tradingPairsFromLocalStorage:o,tradingPairFromQuery:i}=e;if(i){let{baseToken:e,quoteToken:t}=i;if(r(e,t).length)return{baseToken:e,quoteToken:t}}let s=null==o?void 0:o[a.chainId];if(s)try{let e=(0,q._s)(s.baseToken),t=(0,q._s)(s.quoteToken);if(r(e,t).length)return{baseToken:e,quoteToken:t}}catch(e){E.error("Error retrieving pair from local storage",e)}return{baseToken:t(a),quoteToken:n(a)}})({getNativeTokenChain:U,getWrappedNativeTokenChain:L,chain:null!==(n=null==A?void 0:A.chain)&&void 0!==n?n:{chainId:r.Networks.ETHEREUM.chainId,chainType:"evm"},tradingPairFromQuery:F,tradingPairsFromLocalStorage:D.current,getPairApis:R,getQuoteTokens:B})),{token:G,setToken:_,amount:K,setAmount:H}=(0,w.Z)(M.current.baseToken,""),{token:W,setToken:V,amount:z,setAmount:J}=(0,w.Z)(M.current.quoteToken,""),X=("solana"===W.chain.chainType?N:S).sort((e,t)=>t.timeStampMs-e.timeStampMs)[0]||{address:"",identifier:"",timeStampMs:Date.now()},[Y,$]=(0,f.useState)({...X,chainType:W.chain.chainType});(0,f.useEffect)(()=>{let e=("solana"===W.chain.chainType?N:S).sort((e,t)=>t.timeStampMs-e.timeStampMs)[0]||{address:"",identifier:"",timeStampMs:Date.now()};$({...e,chainType:W.chain.chainType})},[S,N,W]);let ee=(0,f.useCallback)((e,t)=>{D.current={...D.current,[e.chain.chainId]:{baseToken:(0,q.w8)(e),quoteToken:(0,q.w8)(t)}},Q(D.current)},[Q]),et=(0,f.useMemo)(()=>R(G,W),[G,W,R]),en=et.length?et.map(e=>e.minQuantity).reduce((e,t)=>void 0===e||void 0===t?void 0:e.isLessThan(t)?e:t):void 0,ea=et.length?et.map(e=>e.maxQuantity).reduce((e,t)=>void 0===e||void 0===t?void 0:e.isGreaterThan(t)?e:t):void 0,{prices:er}=(0,d.L)(),{selectedGasPrice:eo}=(0,u.J)(),ei=null!==(y=null==er?void 0:er[(0,T.Bf)(W)])&&void 0!==y?y:0,es=A?U(A.chain):void 0,el=(0,f.useMemo)(()=>{var e;return W&&ei?(0,k.UK)((null!==(e=null==eo?void 0:eo.price)&&void 0!==e?e:m.ce).multipliedBy(m._0).multipliedBy(ei),W.decimals):0},[W,ei,null==eo?void 0:eo.price]),eu=es?null!==(b=null==er?void 0:er[(0,T.Bf)(es)])&&void 0!==b?b:0:void 0,ec=G?null!==(C=null==er?void 0:er[(0,T.Bf)(G)])&&void 0!==C?C:0:void 0,ed=ei&&ec?ec/ei:0,eh=(0,f.useMemo)(()=>{var e;return es&&eu?(0,k.UK)((null!==(e=null==eo?void 0:eo.price)&&void 0!==e?e:m.ce).multipliedBy(m._0).multipliedBy(eu),es.decimals):0},[es,eu,null==eo?void 0:eo.price]),ep=et.length?(null==et?void 0:null===(t=et[0])||void 0===t?void 0:t.apiType)===x.I.BARTER&&ei>0&&el>0&&ec?new o.Z(eh).dividedBy(ec).multipliedBy(ed):et.map(e=>e.minQuoteQuantity).reduce((e,t)=>void 0===e||void 0===t?void 0:e.isLessThan(t)?e:t):void 0,ef=et.length?et.map(e=>e.maxQuoteQuantity).reduce((e,t)=>void 0===e||void 0===t?void 0:e.isGreaterThan(t)?e:t):void 0,ew=(0,v.Z)(G),em=(0,v.Z)(W);(ew||em)&&ee(G,W),function(e){let{baseToken:t,quoteToken:n}=e,a=(0,p.useRouter)(),r=(0,f.useRef)(a);(0,f.useEffect)(()=>{r.current.replace({query:{...r.current.query,b:"".concat(t.chain.chainId,"-").concat(t.name),q:"".concat(n.chain.chainId,"-").concat(n.name)}},void 0,{shallow:!0})},[t.name,t.chain,n.name,n.chain])}({baseToken:G,quoteToken:W});let eg=(0,v.Z)(A),ev=(0,v.Z)(P);(eg||ev)&&(H(""),J(""));let ex=e=>{let t=String(e),n=t.replace(/[^\d.]/g,"").replace(/^(\d*\.\d*|\d*)/,(e,t)=>t),[a,r]=n.split("."),o=a?new Intl.NumberFormat("en-US").format(parseFloat(a)):"";return void 0!==r?"".concat(o,".").concat(r):o},ey=(0,f.useMemo)(()=>({baseToken:G,quoteToken:W,baseAmount:K.bigNumber,baseAmountString:ex(K.string),quoteAmount:z.bigNumber,quoteAmountString:ex(z.string),setBaseToken:_,setQuoteToken:V,setBaseAmount:H,setQuoteAmount:J,setPreferredPair:ee,selectedPairApis:et,knownTokens:I,getQuoteTokens:B,getPairApis:R,minTradeQuantity:en,maxTradeQuantity:ea,minQuoteTradeQuantity:ep,maxQuoteTradeQuantity:ef,setQuoteWallet:$,quoteWallet:Y,nativeToken:es}),[G,W,K.bigNumber,K.string,z.bigNumber,z.string,_,V,H,J,ee,et,I,B,R,en,ea,ep,ef,$,Y,es]);return(0,a.jsx)(Z,{value:ey,children:j})}},48793:function(e,t,n){n.d(t,{Z:function(){return F}});var a=n(52322),r=n(72558),o=n(72779),i=n.n(o),s=n(76875),l=n(47700),u=n(70933),c=n(4236),d=n(81227),h=n(55847),p=n(88727),f=n(27502);function w(e){let{baseToken:t,quoteToken:n,nativeToken:r,sourceNetworkGasFee:o,crossChainGasFeeEstimate:i,nativeTokenPriceUsd:s}=e,l=(0,h.Gc)();return(0,a.jsx)(d.B,{placement:"large"===l?"top":"top-start",width:250,trigger:"hover",children:(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-1 text-2xs text-gray-4",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)("div",{children:[(0,f.tG)(t.chain).label," Fees"]}),(0,a.jsxs)("div",{children:[(0,p.Aw)((0,p.mD)((0,p.UK)(o.multipliedBy(s),r.decimals),2))," "]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)("div",{children:[(0,f.tG)(n.chain).label," Fees + Relayer Fees"]}),(0,a.jsxs)("div",{children:[(0,p.Aw)((0,p.UK)(i.multipliedBy(s),r.decimals))," "]})]})]}),(0,a.jsx)("hr",{className:"border-gray-0_75"}),(0,a.jsxs)("div",{className:"flex justify-between text-xs text-gray-10",children:[(0,a.jsx)("div",{children:"Total Fees"}),(0,a.jsxs)("div",{children:[(0,p.Aw)((0,p.mD)((0,p.UK)(o.plus(i).multipliedBy(s),r.decimals),2))," "]})]})]})})}var m=n(8225),g=n(75269),v=n(40770),x=n(99585),y=n(38571),k=n(2784);function b(e){let{exchangeRate:t,baseTokenName:n,quoteTokenName:o}=e,[i,s]=(0,k.useState)(!1);return(0,a.jsxs)("button",{onClick:()=>s(e=>!e),className:"flex cursor-pointer",children:[(0,a.jsx)(x.Z,{className:"mr-1 self-center",height:12,width:12}),i?"1 ".concat(o," = ").concat((0,p.Bw)(new r.Z(1).dividedBy(t).toNumber(),y.Df)," ").concat(n):"1 ".concat(n," = ").concat((0,p.Bw)(t.toNumber(),y.Df)," ").concat(o)]})}var T=n(70431),q=n(74887),E=n(32653),Z=n(75763),C=n(92193),j=n(92630),A=n(49073),N=n(16067),S=n(89397),I=n(52420),B=n(9779),R=n(98174);function F(e){var t,n,o,d,h,f,x,y,k,F,O,Q;let D,P,U,L,{exchangeVersion:M,isGasChangerOpen:G,setIsGasChangerOpen:_,isSlippageChangerOpen:K,setIsSlippageChangerOpen:H}=e,{currentWallet:W}=(0,c.OZ)(),{gasPrices:V,selectedGasPrice:z,selectedGasSpeed:J,setSelectedGasSpeed:X,selectedSlippage:Y,setSlippage:$}=(0,E.J)(),{prices:ee}=(0,j.L)(),{getNativeTokenChain:et,getWrappedNativeTokenChain:en}=(0,C.rU)(),ea=(0,m.AK)(),{liquiditySources:er,availableSelectedLiquiditySources:eo}=(0,g.wA)(),ei=(0,v.F)(),{baseToken:es,quoteToken:el}=null!==(y=null===(t=ei.result)||void 0===t?void 0:t.arguments)&&void 0!==y?y:ea,eu=!1,ec=!0,ed=!!_&&!!V&&"v2"===M,eh=(0,Z.C)(),ep=(0,S.Z)(eh(),ei,!0);if(!W)return(0,a.jsx)(a.Fragment,{children:" "});let ef=et(W.chain),ew=en(W.chain),em=null!==(k=null==ee?void 0:ee[(0,N.Bf)(ef)])&&void 0!==k?k:0;if((null===(n=ei.result)||void 0===n?void 0:n.type)==="single-network-trade"&&es&&el&&ef){eu=!0;let e=ei.result.hashflowQuote;P=null==e?void 0:e.gasEstimate,U=null==e?void 0:e.exchangeRate,L=null==e?void 0:e.hftTradingRewards;let t=ei.result.arguments.direction,n=function(e){var t,n,a;let{competitorQuotes:o,direction:i,usdPrices:s,tradeToken:l,nativeToken:u,gasPrice:c}=e;if(0===o.length)return null;if(1===o.length)return o[0];let d=null,h=0,f=null!==(t=null==s?void 0:s[(0,N.Bf)(u)])&&void 0!==t?t:0;for(let e of o){let t=(0,p.UK)(e.value,l.decimals)*(null!==(n=null==s?void 0:s[(0,N.Bf)(l)])&&void 0!==n?n:0),o=(0,p.UK)(new r.Z(null!==(a=null==c?void 0:c.price)&&void 0!==a?a:A.ce).multipliedBy(e.gasEstimate).multipliedBy(f),l.decimals);"sell"===i?(t-o>h||null===d)&&(d=e,h=t-o):(t+o<h||null===d)&&(d=e,h=t+o)}return d}({competitorQuotes:ei.result.competitorQuotes,usdPrices:ee,direction:t,tradeToken:"sell"===t?el:es,nativeToken:ef,gasPrice:z});ec=!!(P&&n&&new r.Z(n.gasEstimate).gt(P))}else if((null===(o=ei.result)||void 0===o?void 0:o.type)==="cross-network-trade"){eu=!0;let e=ei.result.hashflowQuote;P=null==e?void 0:e.gasEstimate,U=null==e?void 0:e.exchangeRate,L=null==e?void 0:e.hftTradingRewards,D=null==e?void 0:e.crossChainGasFeeEstimate,ec=!0}else(null===(d=ei.result)||void 0===d?void 0:d.type)==="wrap-unwrap-token"&&(eu=!0,P=ei.result.gasEstimate,U=new r.Z(1));let eg=(0,I.b)(es,el),ev=(0,I.m)(es,el,ef,ew);return(0,a.jsxs)("div",{className:(0,R.m)("v2"===M?"gap-[4px] text-[10px] font-[590] leading-[14px] ":"gap-1 text-xs","flex flex-col items-stretch text-gray-3"),children:[eo&&(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"uppercase",children:"Liquidity Sources"}),(0,a.jsxs)("div",{className:"text-red-5",children:[eo.length," of"," ",er.length]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:i()("v2"===M&&"uppercase"),children:"Rate"}),(0,a.jsxs)(u.Z,{type:"long",width:130,height:12,loading:ep,children:[ep&&"Loading...",es&&el&&U?(0,a.jsx)("div",{className:i()("font-normal","v2"===M?" text-gray-10":"v1"),children:(0,a.jsx)(b,{exchangeRate:U,baseTokenName:null==es?void 0:es.name,quoteTokenName:null==el?void 0:el.name})}):"-"]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:(0,R.m)("v2"===M&&"uppercase","flex select-none items-center gap-[4px] text-gray-3",!!H&&"cursor-pointer",K&&"text-gray-10"),onClick:()=>{H&&"v2"===M&&H(!K)},children:["Slippage",!!H&&"fetching"!==ei.status&&(0,a.jsx)(s.Z,{className:i()("text-gray-10 transition-transform animation-300",K?"rotate-180 transform text-gray-10":"text-gray-3")})]}),(0,a.jsx)(u.Z,{type:"long",width:25,height:12,loading:ep,children:eu?(0,a.jsx)("div",{className:i()("font-normal","none"===Y.option?"text-green-7":"text-gray-10"),children:(0,q.P6)(Y.option,Y.percentage)}):(0,a.jsx)("div",{children:"-"})})]}),K&&(0,a.jsx)(q.ZP,{selectedSlippage:Y,setSelectedSlippage:$,className:"max-w-[266px]"}),eg?(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("span",{className:i()("v2"===M&&"uppercase"),children:"Total Fees"}),(null===(h=P)||void 0===h?void 0:h.gt(0))&&D&&(0,a.jsx)(w,{baseToken:es,quoteToken:el,nativeToken:ef,sourceNetworkGasFee:(null!==(F=null==z?void 0:z.price)&&void 0!==F?F:A.ce).multipliedBy(P),crossChainGasFeeEstimate:D,nativeTokenPriceUsd:em})]}),(0,a.jsx)(u.Z,{type:"long",width:95,height:12,loading:ep,children:D&&(null===(f=P)||void 0===f?void 0:f.gt(0))?"".concat((0,p.Aw)((0,p.UK)((null!==(O=null==z?void 0:z.price)&&void 0!==O?O:A.ce).multipliedBy(P).plus(D).multipliedBy(em),ef.decimals),2)):(0,a.jsx)("div",{children:"-"})})]}):(0,a.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:(0,R.m)("v2"===M&&"uppercase","flex select-none items-center gap-[4px]",ed&&"cursor-pointer",G&&"text-gray-10"),onClick:()=>{ed&&(null==_||_(!G))},children:["v1"===M?"Gas Estimate":"Network Fee",!!_&&V&&"fetching"!==ei.status&&(0,a.jsx)(s.Z,{className:i()("transition-transform animation-300",G?"rotate-180 transform text-gray-10":"text-gray-3")})]}),(0,a.jsx)(u.Z,{type:"long",width:40,height:12,loading:ep,children:(null===(x=P)||void 0===x?void 0:x.gt(0))?(0,a.jsx)("div",{className:i()("font-normal transition-all",ec?"text-green-7":_&&"v2"===M?"text-gray-10":"text-gray-3"),children:(0,p.Aw)((0,p.mD)((0,p.UK)((null!==(Q=null==z?void 0:z.price)&&void 0!==Q?Q:A.ce).multipliedBy(P).multipliedBy(em),ef.decimals),2))}):(0,a.jsx)("div",{children:"-"})})]}),ed&&G&&(0,a.jsx)(T.ag,{selectedGasSpeed:J,setSelectedGasSpeed:X,className:"px-[2px] py-2",gasEstimate:P})]}),!ev&&"v2"!==M&&(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{children:"Trading Rewards"}),(0,a.jsx)(u.Z,{type:"long",width:25,height:12,loading:ep,children:eu&&L?(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)("div",{className:"flex h-4 w-4 items-center justify-center rounded-full bg-dark-gray-0_5",children:(0,a.jsx)(l.Z,{className:"fill-dark-gray-10",width:9})}),(0,a.jsxs)("div",{className:"text-green-7",children:[(0,p.Bw)((0,p.UK)(L,B.y.decimals),4,0)," ","HFT"]})]}):(0,a.jsx)("div",{children:"-"})})]})]})}},40770:function(e,t,n){n.d(t,{Z:function(){return M},F:function(){return L}});var a=n(52322),r=n(4236),o=n(75269),i=n(50861),s=n(92193),l=n(92115),u=n(27085),c=n(52420),d=n(65500),h=n(72558),p=n(12684),f=n(19783),w=n(8225),m=n(32653),g=n(75763),v=n(92630),x=n(14917),y=n(437),k=n(33589),b=n(49073),T=n(52678),q=n(38571),E=n(2784);function Z(e){let t=(0,E.useRef)(e);return(0,E.useEffect)(()=>{t.current=e},[e]),t}var C=n(86917),j=n(16067),A=n(70977),N=n(38113),S=n(30031),I=n(60715),B=n(26533);function R(e,t){let n=e;return function(e,t){var n,a,r,o,i;switch(t.type){case"initialize-cross-network-trade-quote":return(null===(n=e.result)||void 0===n?void 0:n.type)==="cross-network-trade"?{...e,result:{...e.result,error:void 0}}:{...e,result:{type:"cross-network-trade",hashflowQuote:void 0,arguments:t.arguments}};case"add-hashflow-cross-network-trade-quote":if((null===(a=e.result)||void 0===a?void 0:a.type)!=="cross-network-trade")throw Error("Cannot add Hashflow price to an uninitialized exchange quote.");return{...e,result:{...e.result,hashflowQuote:t.quote}};case"update-cross-network-trade-hashflow-quote-gas-estimate":if((null===(r=e.result)||void 0===r?void 0:r.type)!=="cross-network-trade"||!e.result.hashflowQuote)throw Error("Cannot update hashflow gas prices without hashflow quote.");return{...e,result:{...e.result,hashflowQuote:{...e.result.hashflowQuote,gasEstimate:t.gasEstimate}}};case"update-cross-network-trade-hashflow-quote-gas-fee-estimate":if((null===(o=e.result)||void 0===o?void 0:o.type)!=="cross-network-trade"||!e.result.hashflowQuote)throw Error("Cannot update hashflow gas prices without hashflow quote.");return{...e,result:{...e.result,hashflowQuote:{...e.result.hashflowQuote,gasFeeEstimate:t.gasFeeEstimate}}};case"cross-network-trade-error":if((null===(i=e.result)||void 0===i?void 0:i.type)!=="cross-network-trade")throw Error("Cannot add exchange error to a non-exchange quote.");return{...e,result:{...e.result,type:"cross-network-trade",error:t.error,arguments:t.arguments}};default:return e}}(n=function(e,t){var n,a,r,o,i,s,l,u,c,d;switch(t.type){case"initialize-single-network-trade-quote":return(null===(n=e.result)||void 0===n?void 0:n.type)==="single-network-trade"?{...e,result:{...e.result,apiType:null===(a=e.result)||void 0===a?void 0:a.apiType,error:void 0}}:{...e,result:{apiType:void 0,type:"single-network-trade",hashflowQuote:void 0,competitorQuotes:[],competitorQuotesLoading:{quotes:[],expecting:0,expired:!1},arguments:t.arguments}};case"add-hashflow-single-network-trade-quote":if((null===(r=e.result)||void 0===r?void 0:r.type)!=="single-network-trade")throw Error("Cannot add Hashflow price to an uninitialized exchange quote.");return{...e,result:{...e.result,hashflowQuote:t.quote,apiType:t.apiType}};case"expect-single-network-trade-competitor-quotes":if((null===(o=e.result)||void 0===o?void 0:o.type)!=="single-network-trade")throw Error("Cannot expect quotes on an uninitialized exchange quote.");return{...e,result:{...e.result,competitorQuotesLoading:{quotes:[],expecting:t.expecting,expired:!1}}};case"add-single-network-trade-competitor-quote":if((null===(i=e.result)||void 0===i?void 0:i.type)!=="single-network-trade")throw Error("Cannot add competitor prices to an uninitialized exchange quote.");if(e.result.competitorQuotesLoading.expired){if(e.result.competitorQuotes.length>0)return e;return{...e,result:{...e.result,competitorQuotes:[t.quote]}}}return{...e,result:{...e.result,competitorQuotesLoading:{quotes:[...e.result.competitorQuotesLoading.quotes,t.quote],expecting:e.result.competitorQuotesLoading.expecting-1,expired:!1}}};case"expire-pending-single-network-trade-competitor-quotes":if((null===(s=e.result)||void 0===s?void 0:s.type)!=="single-network-trade")throw Error("Cannot add expected quotes to an uninitialized exchange quote.");if(0===e.result.competitorQuotesLoading.expecting)return e;return{...e,result:{...e.result,competitorQuotes:[...e.result.competitorQuotesLoading.quotes],competitorQuotesLoading:{...e.result.competitorQuotesLoading,expired:!0}}};case"save-single-network-trade-competitor-quotes":if((null===(l=e.result)||void 0===l?void 0:l.type)!=="single-network-trade")throw Error("Cannot add prices to an uninitialized exchange quote.");if(e.result.competitorQuotesLoading.expired)return{...e,result:{...e.result,competitorQuotesLoading:{quotes:[],expecting:0,expired:!1}}};return{...e,result:{...e.result,competitorQuotes:e.result.competitorQuotesLoading.quotes,competitorQuotesLoading:{quotes:[],expecting:0,expired:!1}}};case"single-network-trade-error":if((null===(u=e.result)||void 0===u?void 0:u.type)!=="single-network-trade")throw Error("Cannot add exchange error to a non-exchange quote.");return{...e,result:{...e.result,type:"single-network-trade",error:t.error,arguments:t.arguments}};case"update-single-network-trade-hashflow-quote-gas-estimate":if((null===(c=e.result)||void 0===c?void 0:c.type)!=="single-network-trade"||!e.result.hashflowQuote)throw Error("Cannot update hashflow gas prices without hashflow quote.");return{...e,result:{...e.result,hashflowQuote:{...e.result.hashflowQuote,gasEstimate:t.gasEstimate}}};case"update-single-network-trade-hashflow-quote-gas-fee-estimate":if((null===(d=e.result)||void 0===d?void 0:d.type)!=="single-network-trade"||!e.result.hashflowQuote)throw Error("Cannot update hashflow gas prices without hashflow quote.");return{...e,result:{...e.result,hashflowQuote:{...e.result.hashflowQuote,gasFeeEstimate:t.gasFeeEstimate}}};default:return e}}(n=function(e,t){var n,a;switch(t.type){case"add-wrap-unwrap-token-quote":return{...e,result:{type:"wrap-unwrap-token",direction:t.arguments.direction,amount:t.arguments.amount,arguments:t.arguments,gasEstimate:t.gasEstimate}};case"update-wrap-unwrap-token-gas-estimate":if((null===(n=e.result)||void 0===n?void 0:n.type)!=="wrap-unwrap-token")throw Error("Cannot update hashflow gas prices without wrap/unwrap quote.");return{...e,result:{...e.result,gasEstimate:t.gasEstimate}};case"update-wrap-unwrap-token-hashflow-quote-gas-fee-estimate":if((null===(a=e.result)||void 0===a?void 0:a.type)!=="wrap-unwrap-token")throw Error("Cannot update hashflow gas prices without wrap/unwrap quote.");return{...e,result:{...e.result,gasFeeEstimate:t.gasFeeEstimate}};default:return e}}(n=function(e,t){switch(t.type){case"load":return{...e,status:"fetching"};case"complete":return{...e,status:"idle"};case"reset":return{...e,status:"idle",result:void 0};default:return e}}(n,t),t),t),t)}var F=n(6797),O=n(12806),Q=n(88727),D=n(27502);let[P,U]=(0,u.Z)(),L=U;function M(e){let{children:t}=e,{currentWallet:n}=(0,r.OZ)(),{getNativeTokenChain:u,getWrappedNativeTokenChain:U}=(0,s.rU)(),L=n?u(n.chain):void 0,M=n?U(n.chain):void 0,{getPairApis:G}=(0,i.Zd)(),{selectedLiquiditySources:_}=(0,o.wA)(),[K,H]=(0,E.useReducer)(R,{status:"idle"}),W=(0,F.Z)([n,_,H]),V=(0,F.Z)([n,_,H]),z=function(e){let{currentWallet:t}=(0,r.OZ)(),{getWrappedNativeTokenChain:n}=(0,s.rU)(),{selectedGasPrice:a,isEip1559:o}=(0,m.J)(),{balances:i}=(0,f.ln)(),l=Z(i),{setBaseAmount:u,setQuoteAmount:c}=(0,w.AK)();return(0,E.useCallback)(async r=>{let{baseToken:i,quoteToken:s,direction:p,amount:f,rfqType:w,abortSignal:m}=r;if(!t)throw Error("You must connect a wallet before getting quotes.");if((0,B.tv)({amount:f,baseToken:i,balances:l.current})&&"evm"===t.chain.chainType){if(t.chain.chainId===d.Networks.OPTIMISM.chainId){let r=(0,b.$A)(a,o);r&&(0,B.hm)({wallet:t.wallet,direction:"sell"===p?"wrap":"unwrap",amount:f,wrappedNativeToken:n(i.chain),gasPriceOptions:r}).then(t=>{null!=m&&m.aborted||e({type:"update-wrap-unwrap-token-hashflow-quote-gas-fee-estimate",gasFeeEstimate:t})}).catch(()=>{})}else(0,B.E$)({wallet:t.wallet,direction:"sell"===p?"wrap":"unwrap",amount:f,wrappedNativeToken:n(i.chain)}).then(t=>{m.aborted||e({type:"update-wrap-unwrap-token-gas-estimate",gasEstimate:t})}).catch(()=>{})}"sell"===p?c(f,s):u(f,i),e({type:"add-wrap-unwrap-token-quote",arguments:{direction:p,baseToken:i,quoteToken:s,amount:f,rfqType:w},gasEstimate:new h.Z((null==t?void 0:t.chain.chainType)==="solana"?b.ru:B.mW[t.chain.chainId])}),e({type:"complete"})},[l,e,o,a,u,c,t,n])}(H),J=(0,E.useCallback)(e=>(W.current.abort(),W.current=new AbortController,z({...e,abortSignal:W.current.signal})),[W,z]),X=function(e){let t=(0,g.C)(),{currentWallet:n}=(0,r.OZ)(),{selectedGasPrice:a,isEip1559:i,selectedSlippage:l}=(0,m.J)(),u=Z(l),{getNativeTokenChain:c,getWrappedNativeTokenChain:y}=(0,s.rU)(),{balances:B}=(0,f.ln)(),R=Z(B),{prices:F}=(0,v.L)(),O=Z(F),{allowances:Q}=(0,p.YT)(),D=Z(Q),{setBaseAmount:P,setQuoteAmount:U}=(0,w.AK)(),{setTradeRestriction:L}=(0,x.r)(),{availableSelectedLiquiditySources:M}=(0,o.wA)(),{selectedQuest:G}=(0,A.V)(),{getPairApis:_}=(0,w.AK)();return(0,E.useCallback)(async r=>{var o,s,l;let{direction:p,amount:f,baseToken:w,quoteToken:m,rfqType:g,abortSignal:v}=r;if(!n)throw Error("You must connect a wallet before getting quotes.");let x={direction:p,amount:f,baseToken:w,quoteToken:m,wallet:n,rfqType:g};try{if(e({type:"load"}),e({type:"initialize-single-network-trade-quote",arguments:x}),f.isZero())throw new k.Iw;if((null==M?void 0:M.length)===0)throw new k.dq;let r=_(w,m),T=(0,j.Bf)("sell"===p?w:m),E=null!==(l=O.current[T])&&void 0!==l?l:0,{hashflowQuote:Z,apiType:C}=await (0,k.ZP)({wallet:n,amount:f,baseToken:(0,q.SF)(w)?y(w.chain):w,quoteToken:(0,q.SF)(m)?y(m.chain):m,direction:p,abortSignal:v,liquiditySources:M,rfqType:g,getServerDate:t,trader:null==G?void 0:G.address,effectiveTrader:(null==G?void 0:G.address)?n.address.toString():void 0,source:(null==G?void 0:G.address)?"hashverse":"hashflow",slippageLimit:u.current},r,E);if((null===(o=Z.gasEstimate)||void 0===o?void 0:o.isZero())&&Z.quoteDataV3&&(Z.gasEstimate=new h.Z((0,N.RP)(n.chain))),null==v?void 0:v.aborted)return;if(e({type:"add-hashflow-single-network-trade-quote",quote:Z,apiType:C}),(Z.quoteDataV3||Z.quoteDataBarter||Z.quoteDataJupiter||(null===(s=Z.quoteData)||void 0===s?void 0:s.rfqType)===I.C.RFQT)&&"evm"===n.chain.chainType&&(0,N.ej)({nativeToken:c(n.chain),baseToken:w,balances:R.current,allowances:D.current,contract:Z.quoteDataBarter?Z.quoteDataBarter.contractAddress:await n.wallet.hashflow.contracts.hRouter.getAddress(),hashflowQuote:Z,isBarterTrade:!!(null==Z?void 0:Z.quoteDataBarter)})){if(n.chain.chainId===d.Networks.OPTIMISM.chainId){let t=(0,b.$A)(a,i);t&&(0,N.Qc)({wallet:n.wallet,quoteData:Z.quoteData,signature:Z.signature,gasPriceOptions:t}).then(t=>{null!=v&&v.aborted||e({type:"update-single-network-trade-hashflow-quote-gas-fee-estimate",gasFeeEstimate:t})}).catch(()=>{})}else(0,N.yl)({wallet:n.wallet,quoteData:Z.quoteData,signature:Z.signature}).then(t=>{null!=v&&v.aborted||e({type:"update-single-network-trade-hashflow-quote-gas-estimate",gasEstimate:t})}).catch(()=>{})}if("sell"===p?U(new h.Z(Z.quoteData?Z.quoteData.quoteTokenAmount:Z.quoteDataBarter?Z.quoteDataBarter.quoteTokenAmount:Z.quoteDataV3?Z.quoteDataV3.quoteTokenAmount:Z.quoteDataJupiter.outAmount),m):P(new h.Z(Z.quoteData?Z.quoteData.baseTokenAmount:Z.quoteDataBarter?Z.quoteDataBarter.baseTokenAmount:Z.quoteDataV3?Z.quoteDataV3.baseTokenAmount:Z.quoteDataJupiter.inAmount),w),(0,S.Z)(2e3,v).then(()=>{e({type:"expire-pending-single-network-trade-competitor-quotes"})},()=>{}),null==v?void 0:v.aborted)return;e({type:"complete"})}catch(t){if(t instanceof Error){if(null==v?void 0:v.aborted)return;t instanceof T.k&&t.failure.code in C.O&&L(C.O[t.failure.code]),e({type:"single-network-trade-error",error:t,arguments:x}),"sell"===p?U("",m):P("",w),e({type:"complete"})}else throw t}},[u,n,e,M,_,O,t,null==G?void 0:G.address,c,y,R,D,a,i,U,P,L])}(H),Y=(0,E.useCallback)(e=>(W.current.abort(),W.current=new AbortController,V.current.abort(),V.current=new AbortController,X({...e,abortSignal:(0,l.Z)(W.current.signal,V.current.signal)})),[W,V,X]),$=function(e){let t=(0,g.C)(),{currentWallet:n}=(0,r.OZ)(),{selectedGasPrice:a,isEip1559:l}=(0,m.J)(),{getNativeTokenChain:u}=(0,s.rU)(),{balances:c}=(0,f.ln)(),A=Z(c),{prices:N}=(0,v.L)(),S=Z(N),{allowances:I}=(0,p.YT)(),B=Z(I),{setBaseAmount:R,setQuoteAmount:F,quoteWallet:O}=(0,w.AK)(),{setTradeRestriction:Q}=(0,x.r)(),{availableSelectedLiquiditySources:D}=(0,o.wA)(),{getPairApis:P}=(0,i.Zd)();return(0,E.useCallback)(async r=>{let{baseToken:o,quoteToken:i,direction:s,amount:c,rfqType:p,abortSignal:f}=r;if(!n)throw Error("You must connect a wallet before getting quotes.");let w={direction:s,amount:c,baseToken:o,quoteToken:i,wallet:n,rfqType:p};try{var m,g;if(e({type:"load"}),e({type:"initialize-cross-network-trade-quote",arguments:w}),c.isZero())throw new k.Iw;if((null==D?void 0:D.length)===0)throw new k.dq;let r=P(o,i),v=(0,j.Bf)("sell"===s?o:i),x=null!==(g=S.current[v])&&void 0!==g?g:0,{apiType:T,hashflowQuote:E}=await (0,k.ZP)({wallet:n,amount:c,baseToken:(0,q.SF)(o)?(0,q.IW)(o.chain):o,quoteToken:(0,q.SF)(i)?(0,q.IW)(i.chain):i,direction:s,abortSignal:f,liquiditySources:D,rfqType:p,getServerDate:t,slippageLimit:{option:"none",percentage:0},trader:null==O?void 0:O.address,unwrapOnDstChain:(0,q.SF)(i)},r,x);if((null===(m=E.gasEstimate)||void 0===m?void 0:m.isZero())&&(E.gasEstimate=new h.Z((0,y.pt)(n.chain))),f.aborted||"evm"===n.chain.chainType&&n.wallet.abortSignal.aborted)return;if(e({type:"add-hashflow-cross-network-trade-quote",quote:E,apiType:T}),E.crossChainGasFeeEstimate&&"evm"===n.chain.chainType&&(0,y.eI)({nativeToken:u(o.chain),baseToken:o,balances:A.current,allowances:B.current,contract:await n.wallet.hashflow.contracts.hRouter.getAddress(),hashflowQuote:E})){if(n.chain.chainId===d.Networks.OPTIMISM.chainId){let t=(0,b.$A)(a,l);t&&(0,y.cS)({wallet:n.wallet,baseToken:o,quoteToken:i,quoteData:E.quoteDataV3,signature:E.signature,crossChainGasFeeEstimate:E.crossChainGasFeeEstimate,gasPriceOptions:t}).then(t=>{null!=f&&f.aborted||e({type:"update-cross-network-trade-hashflow-quote-gas-fee-estimate",gasFeeEstimate:t})}).catch(()=>{})}else(0,y.UR)({wallet:n.wallet,baseToken:o,quoteToken:i,quoteData:E.quoteDataV3,signature:E.signature,crossChainGasFeeEstimate:E.crossChainGasFeeEstimate}).then(t=>{f.aborted||e({type:"update-cross-network-trade-hashflow-quote-gas-estimate",gasEstimate:t})}).catch(()=>{})}"sell"===s?F(new h.Z(E.quoteDataV3.quoteTokenAmount),i):R(new h.Z(E.quoteDataV3.baseTokenAmount),o),e({type:"complete"})}catch(t){if(t instanceof Error){if(f.aborted)return;t instanceof T.k&&t.failure.code in C.O&&Q(C.O[t.failure.code]),e({type:"cross-network-trade-error",error:t,arguments:w}),"sell"===s?F("",i):R("",o),e({type:"complete"})}else throw t}},[n,O,e,D,P,t,u,A,B,S,a,l,F,R,Q])}(H),ee=(0,E.useCallback)(e=>(W.current.abort(),W.current=new AbortController,V.current.abort(),V.current=new AbortController,$({...e,abortSignal:(0,l.Z)(W.current.signal,V.current.signal)})),[W,V,$]),et=(0,E.useCallback)(()=>{W.current.abort(),V.current.abort(),V.current=new AbortController,H({type:"reset"})},[H,W,V]);(0,O.Z)(()=>{et()},[n,_,et]);let en=(0,E.useCallback)(async e=>{let{direction:t,amount:n,baseToken:a,quoteToken:r,rfqType:o,minTradeQuantity:i,maxTradeQuantity:s,minQuoteTradeQuantity:l}=e;if(0===G(a,r).length)throw Error("Invalid trading pair.");if(!n.isZero()){if(!n.isEqualTo(n.decimalPlaces(0))||!n.isZero()&&i&&"sell"===t&&i.toNumber()>(0,Q.UK)(n,a.decimals)||!n.isZero()&&l&&"sell"!==t&&(null==l?void 0:l.toNumber())>(0,Q.UK)(n,r.decimals)||s&&"sell"===t&&s.toNumber()<(0,Q.UK)(n,a.decimals)){et();return}return L&&M&&(0,c.m)(a,r,L,M)?await J({direction:t,amount:n,baseToken:a,quoteToken:r,rfqType:o}):(0,D.O8)(a.chain,r.chain)?await Y({direction:t,amount:n,baseToken:a,quoteToken:r,rfqType:o}):await ee({direction:t,amount:n,baseToken:a,quoteToken:r,rfqType:o})}},[G,L,M,et,J,Y,ee]),ea=(0,E.useCallback)((e,t)=>{t.aborted||en(e)},[en]),er=function(e,t){var n;let a;let r=Z(e),o=(0,F.Z)([t]),i=o.current.signal;return(0,E.useCallback)((n=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];i.aborted||r.current(...t)},a=null,function(){for(var e=arguments.length,r=Array(e),o=0;o<e;o++)r[o]=arguments[o];null!==a&&(clearTimeout(a),a=null),a=setTimeout(()=>{n(...r)},t)}),[t,i])}(ea,1500),eo=(0,E.useCallback)(e=>{if(e.amount.isZero()||!e.amount.isEqualTo(e.amount.decimalPlaces(0)))return;W.current.abort(),V.current.abort(),V.current=new AbortController;let t=V.current;H({type:"load"}),er(e,t.signal)},[W,V,H,er]),ei=(0,E.useMemo)(()=>({...K,fetch:en,queueFetch:eo,reset:et}),[K,en,eo,et]);return(0,a.jsx)(P,{value:ei,children:t})}},61910:function(e,t,n){n.d(t,{Z:function(){return u}});var a=n(52322),r=n(84986),o=n(40770),i=n(33589),s=n(30410),l=n(98174);function u(e){let{error:t,pageTheme:n,className:u}=e,c=(0,o.F)(),d=()=>{if(!c.result)throw Error("Cannot refetch quote after it was reset.");c.fetch(c.result.arguments)};return(0,a.jsx)("div",{className:(0,l.m)("flex min-h-[30px] items-center justify-center border border-solid border-red-7 p-2 text-xs text-gray-7","hashverse"!==n&&"rounded",u),children:t instanceof i.Iw?(0,a.jsx)("p",{className:"text-center",children:"Hashflow didn’t receive a quote from market makers because the requested amount was too small. Try choosing a higher amount."}):t instanceof i.UC?(0,a.jsx)("p",{className:"text-center",children:"Hashflow didn’t receive a quote from market makers because there’s not enough liquidity available. Try choosing a lower amount."}):t instanceof i.Wl?(0,a.jsxs)("p",{className:"text-center",children:["Hashflow didn’t receive a quote from market makers.",(0,a.jsx)("br",{}),"Please adjust the trade amount or"," ",(0,a.jsx)(r.Z,{style:"link",size:"x-small",inline:!0,onClick:d,children:"try again."})]}):t instanceof s.Yz||t instanceof i.Cd?(0,a.jsx)("p",{className:"text-center",children:"Hashflow doesn’t support trading for the selected assets. Please change one or both of the assets above."}):t instanceof i.dq?(0,a.jsx)("p",{className:"text-center",children:"None of the liquidity sources you have selected are available. Please enable at least one liquidity source in the exchange settings."}):"Network Error"===t.message?(0,a.jsxs)("p",{className:"text-center",children:["Something went wrong. Please check your internet connection and please"," ",(0,a.jsx)(r.Z,{style:"link",size:"x-small",inline:!0,onClick:d,children:"try again."})]}):(0,a.jsxs)("p",{className:"text-center",children:["Something went wrong. Please"," ",(0,a.jsx)(r.Z,{style:"link",size:"x-small",inline:!0,onClick:d,children:"try again."})]})})}},77992:function(e,t,n){n.d(t,{F:function(){return c}});var a=n(4236),r=n(49524),o=n(40770),i=n(75763),s=n(94180),l=n(2784),u=n(23716);function c(){return!function(){var e;let t=(0,i.C)(),n=(0,r.W)(),c=!!(null===(e=n.state)||void 0===e?void 0:e.status),{currentWallet:d}=(0,a.OZ)(),h=(0,o.F)();(0,s.C)((0,l.useCallback)(()=>{try{var e;if("idle"!==h.status||c||!h.result||(null===(e=h.result)||void 0===e?void 0:e.type)==="wrap-unwrap-token"||h.result.error||!h.result.hashflowQuote||Math.floor(t().valueOf()/1e3)<h.result.hashflowQuote.expires||!d)return;h.fetch(h.result.arguments)}catch(e){u.error(e)}},[h,c,d,t]),1e3)}(),null}},70431:function(e,t,n){n.d(t,{ZP:function(){return k},ag:function(){return y}});var a=n(52322),r=n(72779),o=n.n(r),i=n(45203),s=n(84986),l=n(95376),u=n(55847),c=n(4236),d=n(32653),h=n(92193),p=n(92630),f=n(49073),w=n(88727),m=n(16067),g=n(2784),v=n(98174);function x(e){let{onClick:t,speed:n,selectedGasSpeedLocal:r,gasPrice:o,className:i,gasPriceUsd:s}=e;return(0,a.jsxs)("div",{onClick:t,className:(0,v.m)("relative flex flex-1 cursor-pointer flex-col items-start justify-start gap-[4px] rounded bg-gray-0_5 p-2.5",r===n?"outline outline-[2px] outline-blue-6":"outline outline-[1px] outline-gray-0_75 hover:outline hover:outline-gray-2",i),children:[(0,a.jsx)("div",{className:"text-left text-[10px] uppercase leading-[10px] text-gray-10",children:"".concat(n.slice(0,1).toUpperCase()).concat(n.slice(1))}),(0,a.jsx)("div",{className:"text-left text-[9px] uppercase leading-[9px] text-gray-4",children:null!=s?s:"".concat((0,w.Bw)((0,d.nj)(o.price).toNumber(),0,0)," Gwei")})]})}function y(e){var t;let{selectedGasSpeed:n,setSelectedGasSpeed:r,gasEstimate:o,className:i}=e,{gasPrices:s}=(0,d.J)(),{currentWallet:l}=(0,c.OZ)(),{prices:u}=(0,p.L)(),{getNativeTokenChain:g}=(0,h.rU)();if(!l)return(0,a.jsx)(a.Fragment,{});let y=g(l.chain),k=null!==(t=null==u?void 0:u[(0,m.Bf)(y)])&&void 0!==t?t:0;return(0,a.jsx)("div",{className:(0,v.m)("flex w-full flex-auto items-start gap-2",i),children:(0,f.xl)(l.chain).map(e=>{let t=null==s?void 0:s[e];return t?(0,a.jsx)(x,{onClick:()=>{r(e)},speed:e,selectedGasSpeedLocal:n,gasPrice:t,gasPriceUsd:o&&(0,w.Aw)((0,w.mD)((0,w.UK)(t.price.multipliedBy(o).multipliedBy(k),y.decimals),2))},e):null})})}function k(e){let{onClickBack:t,gasEstimate:n}=e,r=(0,u.Gc)(),{selectedGasSpeed:c,setSelectedGasSpeed:h,gasPrices:p}=(0,d.J)(),[f,w]=(0,g.useState)(c),m=(0,a.jsxs)("div",{className:o()("flex min-h-[360px] min-w-[260px] flex-col items-start justify-start gap-[20px]","small"===r&&"h-full"),children:[(0,a.jsxs)("div",{className:"flex items-start justify-start gap-2.5 self-stretch",children:[(0,a.jsx)("button",{onClick:t,children:(0,a.jsx)(i.Z,{className:"text-gray-0_75 hocus:text-gray-2"})}),(0,a.jsx)("div",{className:"relative flex flex-grow items-center justify-start gap-2",children:(0,a.jsx)("div",{className:"flex h-7 w-48 flex-grow items-center justify-center pr-[28px] text-center text-sm font-bold text-gray-10",children:"Gas Setting"})})]}),(0,a.jsx)("div",{className:"flex flex-grow flex-col items-center justify-center self-stretch",children:p?(0,a.jsx)(y,{selectedGasSpeed:f,setSelectedGasSpeed:w,gasEstimate:n}):(0,a.jsx)("div",{className:"flex flex-col items-center justify-center text-gray-4",children:"No gas prices available."})}),(0,a.jsxs)("div",{className:"flex items-start justify-start gap-2 self-stretch",children:[(0,a.jsx)(s.Z,{size:"unset",style:"secondary",onClick:t,className:"rounded p-[12px] text-[14px] leading-[16px]",children:"Cancel"}),(0,a.jsx)(s.Z,{size:"unset",style:"primary",onClick:()=>{h(f),t()},className:"rounded p-[12px] text-[14px] leading-[16px]",children:"Save"})]})]}),[v,x]=(0,g.useState)(!1);return"large"===r?m:(0,a.jsx)(l.Z,{isOpen:!v,onRequestClose:()=>{x(!0),t()},animationTheme:"fade",pageTheme:"exchange-v2",children:m})}},74887:function(e,t,n){n.d(t,{$4:function(){return l},P6:function(){return u},ZP:function(){return h}});var a=n(52322),r=n(72779),o=n.n(r),i=n(90693),s=n(2784);function l(e,t){return null!==c[e]?c[e]/100:null!==t?t/100:void 0}function u(e,t){switch(e){case"none":return"No Slippage";case"auto":return"Auto";case"custom":return t?"".concat(t,"%"):"-";default:return e}}let c={none:0,auto:.5,"0.1%":.1,"0.5%":.5,"1%":1,custom:null},d=["auto","0.1%","0.5%","1%","custom"];function h(e){let{selectedSlippage:t,setSelectedSlippage:n,className:r}=e,[i,l]=(0,s.useState)(!1);return(0,a.jsx)("div",{className:o()("flex w-full flex-auto items-start gap-2 py-2",r),children:d.map(e=>(0,a.jsx)(p,{onClick:()=>{"custom"===e?l(!0):l(!1),n({option:e,percentage:c[e]})},showInput:i,option:e,selectedSlippage:t,setSlippage:n},e))})}function p(e){var t;let{onClick:n,showInput:r,option:l,selectedSlippage:u,setSlippage:c}=e,d=(0,s.useRef)(null);return(0,s.useEffect)(()=>{if(r){var e;null===(e=d.current)||void 0===e||e.focus()}},[r]),(0,a.jsx)("div",{onClick:n,className:o()("relative flex flex-1 cursor-pointer flex-col items-center justify-center gap-[4px] rounded bg-gray-0_5 p-2",l===u.option?"outline outline-[2px] outline-blue-6":"outline outline-[1px] outline-gray-1"),children:"custom"===l&&r?(0,a.jsxs)("div",{className:"text-left text-[10px] uppercase leading-[14px] text-gray-10",children:[(0,a.jsx)(i.Z,{innerRef:d,validation:"number",placeholder:"",onChange:e=>{100>=Number(e)&&c({option:l,percentage:Number(e)})},value:null!==(t=u.percentage)&&void 0!==t?t:void 0,className:"max-w-[42px] border-none bg-transparent pr-[12px] outline-none placeholder:text-gray-4"}),(0,a.jsx)("div",{className:"absolute right-[8px] top-[10px] text-gray-4",children:"%"})]}):(0,a.jsx)("div",{className:"text-[10px] uppercase leading-[14px] text-gray-10",children:l})})}},78986:function(e,t,n){n.d(t,{P:function(){return q},Z:function(){return E}});var a=n(52322),r=n(45676),o=n(19783),i=n(4236),s=n(8225),l=n(40770),u=n(32653),c=n(70977),d=n(75763),h=n(64601),p=n(83051),f=n(92193),w=n(136),m=n(8710),g=n(27085),v=n(49073),x=n(6797),y=n(12806),k=n(2784);let[b,T]=(0,g.Z)(),q=T;function E(e){let{children:t}=e,{currentWallet:n}=(0,i.OZ)(),g=function(){let e=(0,d.C)(),{currentWallet:t}=(0,i.OZ)(),{selectedGasPrice:n,isEip1559:a}=(0,u.J)(),{addTransactionHistoryEntry:g,updateTransactionHistoryEntry:y}=(0,w.h)(),{leaseProvider:b}=(0,h.R)(),{showToast:T}=(0,p.tF)(),q=(0,l.F)(),{balances:E,refetchBalances:Z}=(0,o.ln)(),{setBaseAmount:C,setQuoteAmount:j}=(0,s.AK)(),{questTokenBalances:A}=(0,c.V)(),{getNativeTokenChain:N,getWrappedNativeTokenChain:S}=(0,f.rU)(),{startTask:I}=(0,r.HJ)(),B=(0,x.Z)([t]),[R,F]=(0,k.useState)(),O=(0,r.GS)(R),{selectedQuest:Q}=(0,c.V)(),D=t?N(t.chain):void 0,P=t?S(t.chain):void 0,U=(0,k.useCallback)(async()=>{var r,o;if(t){if(D&&P){if("evm"!==t.chain.chainType)throw Error("Hashverse is only available on EVM")}else throw Error("Missing native or wrapped native token.")}else throw Error("Expected a wallet to be set.");if((null===(r=q.result)||void 0===r?void 0:r.type)!=="single-network-trade"||!(null===(o=q.result)||void 0===o?void 0:o.hashflowQuote))throw Error("Missing single-network hashverse quest trade quote.");let{arguments:{baseToken:i,quoteToken:s},hashflowQuote:l}=q.result,u=I(m.z,(0,m.Z)({baseToken:i,quoteToken:s,wallet:t.wallet,leaseProvider:b,gasPriceOptions:(0,v.$A)(n,a),addTransactionHistoryEntry:g,updateTransactionHistoryEntry:y,showToast:T,hashflowQuote:l,balances:E,questBalances:A,nativeToken:D,wrappedNativeToken:P,abortSignal:B.current.signal,refetchBalances:Z,getServerDate:e,questAddress:null==Q?void 0:Q.address}));q.reset(),C("",i),j("",s),F(u)},[t,q,I,b,n,a,g,y,T,E,A,D,P,B,Z,e,null==Q?void 0:Q.address,C,j]),L=(0,k.useCallback)(()=>F(void 0),[]);return(0,k.useMemo)(()=>({mutate:U,state:O,reset:L}),[U,O,L])}(),{reset:T}=g;return(0,y.Z)(()=>{T()},[n,T]),(0,a.jsx)(b,{value:g,children:t})}},22650:function(e,t,n){n.d(t,{d:function(){return T},Z:function(){return q}});var a=n(65500),r=n(28879),o=n.n(r),i=n(58540),s=n(88740),l=n(92115),u=n(30031);async function c(e,t){let n=JSON.stringify({types:{EIP712Domain:[{name:"name",type:"string"},{name:"version",type:"string"},{name:"chainId",type:"uint256"},{name:"verifyingContract",type:"address"}],Quote:[{name:"txid",type:"bytes32"},{name:"trader",type:"address"},{name:"baseToken",type:"address"},{name:"quoteToken",type:"address"},{name:"baseTokenAmount",type:"uint256"},{name:"quoteTokenAmount",type:"uint256"},{name:"quoteExpiry",type:"uint256"}]},domain:{name:"Hashflow - Router",version:"1.0",chainId:e.networkId,verifyingContract:await e.hashflow.contracts.hRouter.getAddress()},primaryType:"Quote",message:{txid:t.txid,trader:t.trader,baseToken:t.baseToken,quoteToken:t.quoteToken,baseTokenAmount:t.baseTokenAmount,quoteTokenAmount:t.quoteTokenAmount,quoteExpiry:t.quoteExpiry}});return await e.provider.request({method:"eth_signTypedData_v4",params:[e.address.toLowerCase(),n]})}var d=n(85156),h=n(22510),p=n(52678),f=n(68287),w=n(72744),m=n(17417),g=n(38571),v=n(48935),x=n(88727),y=n(16067),k=n(37164),b=n(81772);let T="execute-single-network-gasless-trade";async function*q(e,t){let{baseToken:n,quoteToken:r,nativeToken:T,wrappedNativeToken:q,wallet:E,balances:Z,addTransactionHistoryEntry:C,updateTransactionHistoryEntry:j,showToast:A,hashflowQuote:N,abortSignal:S,usdPrices:I,refetchBalances:B,getServerDate:R}=e;try{var F,O;let e;e=t||{transactionId:(0,k.x0)(),wallet:E.address,chain:n.chain,stage:"initial"},yield e;let Q=S?(0,l.Z)(E.abortSignal,S):E.abortSignal;if("initial"===e.stage){let t;if((0,d.k)(Q),!N)throw Error("hashflowQuote is required.");if(!Z)throw Error("balances is required.");let o=null!==(F=Z[(0,y.Bf)(n)])&&void 0!==F?F:v.xE,{quoteData:i,baseAmount:s,quoteAmount:l}=N;if(!i)throw Error("Quote data not available.");if((0,d.k)(Q),i.eoa){let e=i.quoteToken===a.ZERO_ADDRESS?q.address:i.quoteToken,n=E.hashflow.token.getToken(e.toString());t=(0,v.UV)(await n.balanceOf(i.eoa))}else{let e=E.hashflow.pool.getPool(i.pool);t=(0,v.UV)(await e.getReserves(i.quoteToken))}if((0,d.k)(Q),t.isLessThan(l))throw new w.ZD(r,l,t);if(s.eq(i.baseTokenAmount)){if(!l.eq(i.quoteTokenAmount))throw new w.m_("Transaction Error","There was an error while verifying the quote data: quote token amounts don’t match. Your transaction was not submitted. Please contact Hashflow support.")}else throw new w.m_("Transaction Error","There was an error while verifying the quote data: base token amounts don’t match. Your transaction was not submitted. Please contact Hashflow support.");if(o.lt(s))throw new w.B9(T,o,s);(0,d.k)(Q),(0,h.XV)(h.cC.EXCHANGE.SUBMIT_TRADE);let u=await c(E,i);132===u.length&&"00"===u.slice(130)&&(u=u.slice(0,130)+"1b"),132===u.length&&"01"===u.slice(130)&&(u=u.slice(0,130)+"1c"),(0,d.k)(Q),e={...e,txid:i.txid,signature:u,values:{baseToken:n,baseAmount:s.toString(),quoteToken:r,quoteAmount:l.toString()},stage:"signed"},yield e,(0,d.k)(Q)}if("signed"===e.stage){(0,d.k)(Q);let{signature:t,txid:a,values:i}=e;if(!t)throw Error("signature is required.");if(!a)throw Error("txid is required.");if(!i)throw Error("values is required.");let{data:{error:s}}=await p.Z.post("/client/api/submit-signed-quote",{source:"hashflow",txid:a,signature:t});if((0,d.k)(Q),s)throw Error("Something went wrong while submitting the trade request.");let l=C({type:"single-network-gasless-trade",chain:i.baseToken.chain,address:E.address,baseToken:(0,b.w8)(n),baseAmount:i.baseAmount,quoteToken:(0,b.w8)(r),quoteAmount:i.quoteAmount,transactionHash:"",createdAt:o()(R()).unix(),status:"Pending",stage:"submitted-to-hashflow",txid:a,transactionId:e.transactionId});e={...e,historyEntryId:l,stage:"submitted-to-hashflow"},yield e,(0,d.k)(Q)}if("submitted-to-hashflow"===e.stage){(0,d.k)(Q);let{txid:t,values:a,historyEntryId:o}=e;if(!t)throw Error("txid is required.");if(!a)throw Error("values is required.");if(!o)throw Error("historyEntryId is required.");let l=!0;for(;l;){let e=0;try{let{data:{quoteState:e,transactionHash:i}}=await p.Z.get("/client/api/quote-status",{params:{txid:t}});(0,d.k)(Q),"failed"===e||"not_found"===e?(j(o,{status:"Error",...i&&{transactionHash:i}}),(0,s._)({status:"failed"===e?"Error":"Dropped",toastTitle:"Trading ".concat((0,x.Bw)((0,x.UK)(a.baseAmount,n.decimals),g.Df)," ").concat(n.name," to ").concat((0,x.Bw)((0,x.UK)(a.quoteAmount,r.decimals),g.Df)," ").concat(r.name," failed"),showToast:A})):"submitted"===e?j(o,{status:"Pending",...i&&{transactionHash:i}}):"confirmed"===e&&(l=!1,j(o,{status:"Success",...i&&{transactionHash:i}}))}catch(t){if((0,f.eE)(t)){if((e+=1)>5)throw t}else throw t}l&&await (0,u.Z)(4e3,Q)}(0,d.k)(Q),A({type:i.KN,title:"Traded ".concat((0,x.Bw)((0,x.UK)(a.baseAmount,n.decimals),g.Df)," ").concat(n.name," to \n        ").concat((0,x.Bw)((0,x.UK)(a.quoteAmount,r.decimals),g.Df)," ").concat(r.name),status:"success",options:{preventiveTransactionPanelStages:["completed"]}}),B();let c=(null!==(O=I[(0,y.Bf)(n)])&&void 0!==O?O:0)*(0,x.UK)(a.baseAmount,n.decimals);(0,h.XV)(h.cC.EXCHANGE.SINGLE_NETWORK_GASLESS_TRADE_COMPLETE,c),(0,m.E)(m.k.EXCHANGE.SINGLE_NETWORK_GASLESS_TRADE_COMPLETE,c),(0,h.XV)(h.cC.EXCHANGE.TRADE_COMPLETE,c)}return{...e,stage:"confirmed"}}catch(e){throw(0,f.SC)(e)}}},26533:function(e,t,n){n.d(t,{E$:function(){return N},Yo:function(){return I},ZP:function(){return B},hm:function(){return S},hp:function(){return j},mW:function(){return C},tv:function(){return A}});var a=n(5790),r=n(30020),o=n(27158),i=n(72558),s=n(28879),l=n.n(s),u=n(58540),c=n(88740),d=n(92115),h=n(85156),p=n(22510),f=n(49073),w=n(68287),m=n(72744),g=n(3457),v=n(17417),x=n(38571),y=n(48935),k=n(88727),b=n(27502),T=n(16067),q=n(37164),E=n(49873),Z=n(81772);let C={[E.QX.chainId]:4e4,[E.vT.chainId]:4e4,[E.NM.chainId]:4e4,[E.KX.chainId]:46e3,[E.Vp.chainId]:46e3,[E.cc.chainId]:44e3,[E.u9.chainId]:44e3,[E.PO.chainId]:55e4,[E.lg.chainId]:45e3,[E.tH.chainId]:45e3,[E.Qz.chainId]:45e3,[E.T2.chainId]:45e3};function j(e){return"solana"===e.chainType?f.ru:C[e.chainId]}function A(e){var t;let{baseToken:n,amount:a,balances:r}=e,o=null!==(t=r[(0,T.Bf)(n)])&&void 0!==t?t:y.xE;return!o.lt(a)}async function N(e){let{wallet:t,direction:n,amount:a,wrappedNativeToken:r}=e;(0,h.k)(t.abortSignal);let o=t.hashflow.token.getWethContract(r.address.toString());return(0,y.UV)("wrap"===n?await o.deposit.estimateGas({value:a.toFixed()}):await o.withdraw.estimateGas(a.toFixed()))}async function S(e){let{wallet:t,direction:n,amount:a,wrappedNativeToken:r,gasPriceOptions:o}=e;if(t.networkId!==E.lg.chainId)throw Error("Can only estimate op gas on Optimism network.");(0,h.k)(t.abortSignal);let i=t.hashflow.token.getWethContract(r.address.toString()),s=(0,y.UV)("wrap"===n?await t.hashflow.optimism.estimateOptimismL1GasFee(await i.deposit.populateTransaction({...o,value:a.toFixed()})):await t.hashflow.optimism.estimateOptimismL1GasFee(await i.withdraw.populateTransaction(a.toFixed(),{...o}))),l=(0,y.UV)("wrap"===n?await i.deposit.estimateGas({value:a.toFixed()}):await i.withdraw.estimateGas(a.toFixed()));return(0,f.e3)(o,l,s)}let I="execute-wrap-unwrap-token";async function*B(e){let{direction:t,unwrappedToken:n,wrappedToken:s,amount:E,wallet:C,leaseProvider:j,balances:A,addTransactionHistoryEntry:N,updateTransactionHistoryEntry:S,showToast:I,gasPriceOptions:B,abortSignal:R,gasEstimate:F,gasFeeEstimate:O,usdPrices:Q,refetchBalances:D,getServerDate:P}=e;try{var U,L,M;let e;let w="evm"===C.chain.chainType,G=w?(0,d.Z)(C.wallet.abortSignal,R):R;(0,h.k)(G);let _="wrap"===t?n:s,K="wrap"===t?s:n,H=null!==(U=A[(0,T.Bf)(_)])&&void 0!==U?U:y.xE,W=null!==(L=A[(0,T.Bf)(n)])&&void 0!==L?L:y.xE,V={transactionId:(0,q.x0)(),wallet:C.address.toString(),chain:_.chain,values:{baseToken:_,baseAmount:E.toString(),quoteToken:K,quoteAmount:E.toString()},stage:"initial"};yield V;let z=null!=O?O:(0,f.Ld)(B,new i.Z(F));if((0,T.RZ)(_,n)){if(W.lt(E))throw new m.B9(n,W,W.plus(z));if(W.minus(E).lt(z))throw new m.gr(n,W.minus(E),z)}else{if(H.lt(E))throw new m.B9(n,H,E);if(W.lt(z))throw new m.gr(n,W,z)}if(w){let n=C.wallet,a=n.hashflow.token.getWethContract(s.address.toString()),{hash:r}="wrap"===t?await a.deposit({...B,value:E.toFixed()}):await a.withdraw(E.toFixed(),B);e=r}else{let n=C.wallet,i=n.anchorWallet.publicKey,s=await (0,a.Am)(r.Gd,i);if("wrap"===t){let t=await (0,g.I0)(n.anchorWallet.publicKey,n.connection,E.toNumber(),!0),a=new o.YW().add(...t),r=await n.anchorWallet.sendTransaction(a,n.connection);e=r}else{let t=await (0,g.sm)(n.anchorWallet.publicKey,n.connection,E.toNumber(),s),a=new o.YW().add(...t),r=await n.anchorWallet.sendTransaction(a,n.connection);e=r}}if(!e)throw Error("Transaction did not return a hash");(0,h.k)(G),(0,p.XV)(p.cC.EXCHANGE.SUBMIT_TRADE);let J=N({type:"wrap"===t?"wrap-token":"unwrap-token",chain:_.chain,address:C.address.toString(),baseToken:(0,Z.w8)(_),quoteToken:(0,Z.w8)(K),amount:E.toFixed(),transactionHash:e,createdAt:l()(P()).unix(),status:"Pending",transactionId:V.transactionId});V={...V,transactionHash:e,historyEntryId:J,stage:"submitted"},yield V,(0,h.k)(G);let X={status:"Pending"};if("evm"===C.chain.chainType)X=await (0,c.q)(_.chain,e,j,R);else if("solana"===C.chain.chainType){let t=C.wallet,n=await (0,g.gG)(t.connection,e);X=n?{status:"Success"}:{status:"Error"}}S(J,{status:X.status}),(0,c._)({status:X.status,toastTitle:"".concat("wrap"===t?"Wrapping":"Unwrapping"," ").concat((0,k.Bw)((0,k.UK)(E,_.decimals),x.Df)," ").concat(_.name," failed"),toastSubtitle:(0,b.tG)(_.chain).label,showToast:I}),I({type:u.KN,title:"".concat("wrap"===t?"Wrapped":"Unwrapped"," ").concat((0,k.Bw)((0,k.UK)(E,_.decimals),x.Df)," ").concat(_.name),subtitle:(0,b.tG)(_.chain).label,status:"success",options:{preventiveTransactionPanelStages:["completed"]}}),D();let Y=(null!==(M=Q[(0,T.Bf)(_)])&&void 0!==M?M:0)*(0,k.UK)(V.values.baseAmount,_.decimals);return(0,p.XV)(p.cC.EXCHANGE.WRAP_UNWRAP_COMPLETE,Y),(0,v.E)(v.k.EXCHANGE.WRAP_UNWRAP_COMPLETE,Y),{...V,stage:"confirmed"}}catch(e){throw(0,w.SC)(e)}}},8710:function(e,t,n){n.d(t,{Z:function(){return T},z:function(){return b}});var a=n(65500),r=n(28879),o=n.n(r),i=n(58540),s=n(38113),l=n(88740),u=n(92115),c=n(85156),d=n(49073),h=n(68287),p=n(72744),f=n(17417),w=n(38571),m=n(30410),g=n(48935),v=n(88727),x=n(16067),y=n(37164),k=n(81772);let b="hashverse-quest-trade";async function*T(e){let{baseToken:t,quoteToken:n,nativeToken:r,wrappedNativeToken:b,wallet:T,leaseProvider:q,balances:E,questBalances:Z,addTransactionHistoryEntry:C,updateTransactionHistoryEntry:j,showToast:A,gasPriceOptions:N,hashflowQuote:S,abortSignal:I,refetchBalances:B,getServerDate:R,questAddress:F}=e;try{var O,Q;let e;let{quoteDataV3:h,signature:D,baseAmount:P,quoteAmount:U}=S;if(!h)throw Error("Quote data not available.");if(!D)throw Error("Missing or invalid quote.");if(!F)throw Error("Quest address missing");let L={transactionId:(0,y.x0)(),wallet:T.address,chain:t.chain,stage:"initial",values:{baseToken:t,baseAmount:P.toString(),quoteToken:n,quoteAmount:U.toString()},quoteExpiry:h.quoteExpiry};yield L;let M=(0,u.Z)(T.abortSignal,I);(0,c.k)(M);let G=null!==(O=Z[(0,x.zS)((0,m.$p)(t))])&&void 0!==O?O:g.xE,_=null!==(Q=E[(0,x.Bf)(r)])&&void 0!==Q?Q:g.xE;if(h.externalAccount&&h.externalAccount!==a.ZERO_ADDRESS){let t=h.quoteToken===a.ZERO_ADDRESS?b.address:h.quoteToken,n=T.hashflow.token.getToken(t.toString());e=(0,g.UV)(await n.balanceOf(h.externalAccount))}else{let t=T.hashflow.pool.getPool(h.pool);e=(0,g.UV)(await t.getReserves(h.quoteToken))}if((0,c.k)(M),e.isLessThan(U))throw new p.ZD(n,U,e);if(P.eq(h.baseTokenAmount)){if(!U.eq(h.quoteTokenAmount))throw new p.m_("Transaction Error","There was an error while verifying the quote data: quote token amounts don’t match. Your transaction was not submitted. Please contact Hashflow support.")}else throw new p.m_("Transaction Error","There was an error while verifying the quote data: base token amounts don’t match. Your transaction was not submitted. Please contact Hashflow support.");let K=T.hashflow.hashverse.getQuest(F);(0,c.k)(M);let{quote:H,value:W}=(0,s.tj)({quoteData:h,signature:D});H.trader=F,H.effectiveTrader=T.address;let V=(0,g.UV)(await K.trade.estimateGas(H)),z=(0,d.Ld)(N,V);if(G.lt(P))throw new p.B9(t,G,P);if(_.lt(z))throw new p.gr(r,_,z);let{hash:J}=await K.trade(H,{value:W,...N});(0,c.k)(M);let X=C({chain:t.chain,address:T.address,baseToken:(0,k.w8)(t),baseAmount:P.toString(),quoteToken:(0,k.w8)(n),quoteAmount:U.toString(),transactionHash:J,createdAt:o()(R()).unix(),status:"Pending",transactionId:L.transactionId,type:"hashverse-quest-trade"});L={...L,transactionHash:J,historyEntryId:X,stage:"submitted"},yield L,(0,c.k)(M);let Y=await (0,l.q)(t.chain,J,q,I);return j(X,{status:Y.status}),(0,l._)({status:Y.status,toastTitle:"Trading ".concat((0,v.Bw)((0,v.UK)(P,t.decimals),w.Df)," ").concat(t.name," to\n        ").concat((0,v.Bw)((0,v.UK)(U,n.decimals),w.Df)," ").concat(n.name," failed"),showToast:A}),A({type:i.KN,title:"Traded ".concat((0,v.Bw)((0,v.UK)(P,t.decimals),w.Df)," ").concat(t.name," to \n        ").concat((0,v.Bw)((0,v.UK)(U,n.decimals),w.Df)," ").concat(n.name," in Hashverse Quest"),status:"success"}),B(),(0,f.E)(f.k.HASHVERSE.HASHVERSE_TRADE_COMPLETE,P.toNumber(),t.name),{...L,stage:"confirmed"}}catch(e){throw(0,h.SC)(e)}}},33589:function(e,t,n){n.d(t,{Cd:function(){return g},Iw:function(){return v},Ny:function(){return b},UC:function(){return x},Wl:function(){return m},ZP:function(){return q},dq:function(){return y}});var a=n(89644),r=n.n(a),o=n(72558),i=n(28879),s=n.n(i),l=n(74887),u=n(49073),c=n(52678),d=n(52784),h=n(88943),p=n(88727),f=n(27502),w=n(39382);class m extends Error{}class g extends Error{}class v extends Error{}class x extends Error{}class y extends Error{}class k extends Error{}let b=18,T=[h.I.BARTER,h.I.V3,h.I.JUPITER,h.I.V2];async function q(e,t,n){let a;let r=function(e,t){let n=new o.Z(t);return e.filter(e=>{let t=void 0===e.minQuantity||n.isGreaterThanOrEqualTo(e.minQuantity),a=void 0===e.maxQuantity||n.isLessThanOrEqualTo(e.maxQuantity);return t&&a})}(t,(0,p.UK)(e.amount,e.baseToken.decimals));if(e.amount.isZero())throw new v;let i=function(e,t,n){let{amount:a,direction:r,quoteToken:i,baseToken:s}=e,l=n?a.dividedBy(new o.Z(10).pow(("sell"===r?s:i).decimals)).multipliedBy(n).toNumber():void 0;return t.sort((e,t)=>{let n=e.apiType,a=t.apiType;return n===a?0:n===h.I.BARTER&&a===h.I.V3?l&&l>1e4?-1:1:n===h.I.V3&&a===h.I.BARTER?l&&l<1e4?-1:1:T.indexOf(n)-T.indexOf(a)})}(e,r,n);if(0===i.length)throw Error("No API found");for(let t of i)try{let{hashflowQuote:n,slippage:a}=await E(e,t.apiType);return{hashflowQuote:n,slippage:a,apiType:t.apiType}}catch(e){a=e}if(a)throw a;throw Error("All API calls failed")}async function E(e,t){switch(t){case h.I.BARTER:return await C(e);case h.I.V3:return await j(e);case h.I.JUPITER:return await Z(e);default:return await A(e)}}async function Z(e){let t,{baseToken:n,quoteToken:a,direction:i,amount:l,wallet:c,abortSignal:h,getServerDate:p,trader:f,slippageLimit:w}=e;if("solana"!==c.chain.chainType)throw Error("Non-Solana wallet not supported in jupiter trade");"none"===w.option&&(w.option="auto");let m=n.address.toString(),g=a.address.toString(),v=100*(w.percentage||.5),{data:x}=await r().get("https://quote-api.jup.ag/v6/quote?inputMint=".concat(m,"&outputMint=").concat(g,"&amount=").concat(l.toString(),"&swapMode=").concat("sell"===i?"ExactIn":"ExactOut","&platformFeeBps=").concat(d.b6,"&slippageBps=").concat(v));if(h.aborted)throw Error("Fetching quotes was aborted.");if(!(null==x?void 0:x.inAmount)||!(null==x?void 0:x.outAmount))throw Error("Missing quote data.");let y=x.inAmount,k=x.outAmount;t=new o.Z("sell"===i?k:y);let T=new o.Z(k).dividedBy(new o.Z(10).pow(a.decimals)).dividedBy(new o.Z(y).dividedBy(new o.Z(10).pow(n.decimals))),q=p();return{slippage:w,hashflowQuote:{baseAmount:"sell"===i?l:t,quoteAmount:"sell"===i?t:l,exchangeRate:T,hashflowOfferingAmount:t,gasEstimate:new o.Z(u.ru),hftTradingRewards:new o.Z(0),direction:i,lastFetched:s()(q).unix(),expires:s()(q).unix()+b,signature:"",quoteDataJupiter:x}}}async function C(e){let t,{baseToken:n,quoteToken:a,direction:r,amount:i,wallet:d,abortSignal:h,getServerDate:p,trader:f,slippageLimit:y}=e;if("evm"!==d.chain.chainType)throw Error("Non-EVM wallet not supported in barter trade");"none"===y.option&&(y.option="auto");let{data:T}=await c.Z.post("/client/aggregator-quote",{baseChain:{chainType:"evm",chainId:n.chain.chainId},quoteChain:{chainType:"evm",chainId:a.chain.chainId},baseToken:n.address.toString(),quoteToken:a.address.toString(),baseTokenAmount:"sell"===r?i.toFixed():void 0,quoteTokenAmount:"buy"===r?i.multipliedBy(1).toFixed():void 0,trader:f||d.address.toString(),slippageLimit:(0,l.$4)(y.option,y.percentage),estimationFactor:"buy"===r?1.03:void 0});if(h.aborted)throw Error("Fetching quotes was aborted.");if("success"!==T.status){var q;if(T.error){if(null===(q=T.error)||void 0===q?void 0:q.code)switch(T.error.code){case w.h7:throw new m;case w.e1:throw new g;case w.b9:throw new x;case w.gs:throw new v;case w.zj:throw new k}else throw Error("Could not generate quote for the selected amount.")}}let{baseAmount:E,quoteAmount:Z,quote:{to:C,gasLimit:j,value:A,data:N}}=T;if(!E||!Z||!C||!j)throw Error("Missing quote data.");t=new o.Z("sell"===r?Z:E);let S=new o.Z(Z).dividedBy(new o.Z(10).pow(a.decimals)).dividedBy(new o.Z(E).dividedBy(new o.Z(10).pow(n.decimals))),I=p(),B=s()(I).unix()+b,R=new o.Z(0);try{let e={from:d.address.toString(),to:C,value:A,data:N},t=d.wallet,n=await t.provider.request({method:"eth_estimateGas",params:[e]});R=new o.Z(n,16)}catch(e){R=new o.Z(u._0)}return{slippage:y,hashflowQuote:{baseAmount:new o.Z(E),quoteAmount:new o.Z(Z),exchangeRate:S,hashflowOfferingAmount:t,gasEstimate:R,hftTradingRewards:new o.Z(0),direction:r,lastFetched:s()(I).unix(),expires:B,signature:"",quoteDataBarter:{value:A,data:N,contractAddress:C,gasLimit:new o.Z(j),quoteExpiry:B,baseTokenAmount:E,quoteTokenAmount:Z}}}}async function j(e){let t,{baseToken:n,quoteToken:a,direction:r,amount:i,wallet:l,abortSignal:u,liquiditySources:d,getServerDate:h,trader:p,effectiveTrader:f,source:y,slippageLimit:k,unwrapOnDstChain:T}=e;"none"!==k.option&&(k.option="none");let{data:q}=await c.Z.post("/client/v3/rfq",{baseChain:n.chain,quoteChain:a.chain,source:null!=y?y:"hashflow",rfqs:[{baseToken:n.address.toString(),quoteToken:a.address.toString(),baseTokenAmount:"sell"===r?i.toFixed():void 0,quoteTokenAmount:"buy"===r?i.toFixed():void 0,trader:p||l.address.toString(),...f&&{effectiveTrader:f},marketMakers:d,options:{doNotUnwrapDstToken:T?!T:void 0}}]});if(u.aborted)throw Error("Fetching quotes was aborted.");if("success"!==q.status){var E;if(q.error){if(null===(E=q.error)||void 0===E?void 0:E.code)switch(q.error.code){case w.h7:throw new m;case w.e1:throw new g;case w.b9:throw new x;case w.gs:throw new v}else throw Error("Could not generate quote for the selected amount.")}}if("success"!==q.status||1!==q.quotes.length)throw Error("Missing quote data.");let{quoteData:Z,signature:C,hftTradingRewards:j,xChainFeeEstimate:A}=q.quotes[0];t=new o.Z("sell"===r?Z.quoteTokenAmount:Z.baseTokenAmount);let N=new o.Z(Z.quoteTokenAmount).dividedBy(new o.Z(10).pow(a.decimals)).dividedBy(new o.Z(Z.baseTokenAmount).dividedBy(new o.Z(10).pow(n.decimals))),S=h();return{slippage:k,hashflowQuote:{baseAmount:"sell"===r?i:t,quoteAmount:"sell"===r?t:i,exchangeRate:N,hashflowOfferingAmount:t,gasEstimate:new o.Z(0),hftTradingRewards:new o.Z(null!=j?j:0),direction:r,lastFetched:s()(S).unix(),expires:s()(S).unix()+b,quoteData:void 0,quoteDataV3:Z,signature:C,crossChainGasFeeEstimate:new o.Z(A||0)}}}async function A(e){let t,{baseToken:n,quoteToken:a,direction:r,amount:i,wallet:l,abortSignal:u,liquiditySources:d,rfqType:h,getServerDate:p,trader:y,effectiveTrader:k,source:T,slippageLimit:q}=e;if("evm"!==l.chain.chainType)throw Error("Non-EVM wallet not supported in fetchTradeQuoteV2");let E=l.wallet;"none"!==q.option&&(q.option="none");let{data:Z}=await c.Z.post("/client/api/rfq",{networkId:E.networkId,source:null!=T?T:"hashflow",baseToken:n.address.toString(),quoteToken:a.address.toString(),baseTokenAmount:"sell"===r?i.toFixed():void 0,quoteTokenAmount:"buy"===r?i.toFixed():void 0,trader:y||l.address,marketMakers:d,...!(0,f.O8)(n.chain,a.chain)&&{dstNetworkId:a.chain.chainId},rfqType:h,...k&&{effectiveTrader:k}});if(u.aborted)throw Error("Fetching quotes was aborted.");if("success"!==Z.status){var C;if(!Z.error&&Z.quoteData);else if(null===(C=Z.error)||void 0===C?void 0:C.code)switch(Z.error.code){case w.h7:throw new m;case w.e1:throw new g;case w.b9:throw new x;case w.gs:throw new v}else throw Error("Could not generate quote for the selected amount.")}let{quoteData:j,signature:A="",gasEstimate:N,hftTradingRewards:S,xChainProtocol:I}=Z;if(!j)throw Error("Missing quote data.");t=new o.Z("sell"===r?j.quoteTokenAmount:j.baseTokenAmount);let B=new o.Z(j.quoteTokenAmount).dividedBy(new o.Z(10).pow(a.decimals)).dividedBy(new o.Z(j.baseTokenAmount).dividedBy(new o.Z(10).pow(n.decimals))),R=p();return{slippage:q,hashflowQuote:{baseAmount:"sell"===r?i:t,quoteAmount:"sell"===r?t:i,exchangeRate:B,hashflowOfferingAmount:t,gasEstimate:new o.Z(null!=N?N:0),hftTradingRewards:new o.Z(null!=S?S:0),direction:r,lastFetched:s()(R).unix(),expires:s()(R).unix()+b,quoteData:j,signature:A,xChainProtocol:I}}}},89397:function(e,t,n){n.d(t,{Z:function(){return r},g:function(){return a}});let a=2;function r(e,t){var n,r;let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("idle"===t.status||(null===(n=t.result)||void 0===n?void 0:n.type)==="wrap-unwrap-token")return!1;if(!(null===(r=t.result)||void 0===r?void 0:r.hashflowQuote)||o&&"fetching"===t.status)return!0;let i=t.result.hashflowQuote.expires-Math.floor(e.valueOf()/1e3);return i+a<0}},52420:function(e,t,n){n.d(t,{b:function(){return o},m:function(){return r}});var a=n(16067);function r(e,t,n,r){return!!((0,a.RZ)(e,n)&&(0,a.RZ)(t,r)||(0,a.RZ)(t,n)&&(0,a.RZ)(e,r))}function o(e,t){return e.chain.chainId!==t.chain.chainId||e.chain.chainType!==t.chain.chainType}},72673:function(e,t,n){n.d(t,{Z:function(){return I}});var a=n(72558),r=n(19783),o=n(4236),i=n(8225),s=n(40770),l=n(50861),u=n(32653),c=n(70977),d=n(64601),h=n(92193),p=n(437),f=n(38113),w=n(26533),m=n(85156),g=n(52678);async function v(e,t,n,r){let o={source:"hashflow",wallet:n,srcChainType:e.chainType,srcNetworkId:String(e.chainId),dstChainType:t.chainType,dstNetworkId:String(t.chainId),protocol:String(r)},{data:i}=await g.Z.get("/client/xchain-fee-estimate",{params:o});if("success"===i.status&&i.estimatedFees)return new a.Z(i.estimatedFees);throw Error("Could not fetch cross-chain fee estimates.")}var x=n(52420),y=n(49073),k=n(30410),b=n(6797),T=n(94180),q=n(48935),E=n(27502),Z=n(16067),C=n(65500),j=n(49873);let A=new Set([...Object.values(C.Networks).filter(e=>!!e.wormholeChainId).map(e=>e.chainId),...j.R3.filter(e=>!!e.wormholeChainId).map(e=>e.chainId)]);var N=n(2784),S=n(60715);function I(){let{baseToken:e,baseAmount:t,baseAmountString:n,quoteToken:g,quoteAmount:j,quoteAmountString:I,setBaseToken:B,setQuoteToken:R,setBaseAmount:F,setQuoteAmount:O,getQuoteTokens:Q,getPairApis:D,minTradeQuantity:P,maxTradeQuantity:U,minQuoteTradeQuantity:L}=(0,i.AK)(),{currentWallet:M}=(0,o.OZ)(),G=(0,s.F)(),{balances:_}=(0,r.ln)(),{selectedGasPrice:K}=(0,u.J)(),{tradingPairsV3:H}=(0,l.Zd)(),{selectedQuest:W}=(0,c.V)(),V=null==W?void 0:W.depositTokens,z=W&&V?H.filter(e=>V.some(t=>(0,Z.RZ)(t,e.baseToken))&&V.some(t=>(0,Z.RZ)(t,e.quoteToken))):void 0,{getNativeTokenChain:J,getWrappedNativeTokenChain:X}=(0,h.rU)(),Y=(0,N.useRef)("base"),{leaseProvider:$}=(0,d.R)(),ee=(0,N.useCallback)(n=>{if(!M||(0,Z.RZ)(e,n))return;G.reset();let r=z?z.filter(e=>(0,Z.RZ)(e.baseToken,n)):Q(n),o="base"===Y.current?"quote":"base";if(B(n),"base"===o)F("",n),r.length&&!j.isZero()&&G.fetch({minQuoteTradeQuantity:L,baseToken:n,quoteToken:g,direction:"buy",amount:j,rfqType:S.C.RFQT,walletBalances:_,minTradeQuantity:P,maxTradeQuantity:U});else if(O("",g),r.length&&!t.isZero()){let r=new a.Z(t.dividedBy(new a.Z(10).pow(e.decimals))).multipliedBy(new a.Z(10).pow(n.decimals));G.fetch({baseToken:n,quoteToken:g,direction:"sell",amount:r,walletBalances:_,rfqType:S.C.RFQT})}},[M,e,G,z,Q,B,F,j,L,g,_,P,U,O,t]),et=(0,N.useCallback)(n=>{if(!M||(0,Z.RZ)(g,n))return;G.reset();let r=z?(0,k.fn)(z,e,n):D(e,n).length>0,o="quote"===Y.current?"base":"quote";if(R(n),"quote"===o)O("",n),r&&!t.isZero()&&G.fetch({minQuoteTradeQuantity:L,baseToken:e,quoteToken:n,direction:"sell",amount:t,rfqType:S.C.RFQT,walletBalances:_,minTradeQuantity:P,maxTradeQuantity:U});else if(F("",e),r&&!j.isZero()){let t=new a.Z(j.dividedBy(new a.Z(10).pow(g.decimals))).multipliedBy(new a.Z(10).pow(n.decimals));G.fetch({minQuoteTradeQuantity:L,baseToken:e,quoteToken:n,direction:"buy",amount:t,rfqType:S.C.RFQT,walletBalances:_,minTradeQuantity:P,maxTradeQuantity:U})}},[M,g,G,z,e,D,R,O,t,L,_,P,U,F,j]),en=(0,N.useCallback)(n=>{if((0,E.O8)(g.chain,n))return;let r=Q(e).find(e=>(0,E.O8)(e.chain,n));if(!r)throw Error("No valid trading pairs with base ".concat((0,Z.Bf)(e)," and quote network ").concat((0,E.WX)(n),"."));G.reset();let o="quote"===Y.current?"base":"quote";if(R(r),"quote"===o)O("",r),t.isZero()||G.fetch({baseToken:e,quoteToken:r,direction:"sell",amount:t,rfqType:S.C.RFQT,walletBalances:_,minTradeQuantity:P,maxTradeQuantity:U,minQuoteTradeQuantity:L});else if(F("",e),!j.isZero()){let t=new a.Z(j.dividedBy(new a.Z(10).pow(g.decimals))).multipliedBy(new a.Z(10).pow(r.decimals));G.fetch({baseToken:e,quoteToken:r,direction:"buy",amount:t,rfqType:S.C.RFQT,walletBalances:_,minTradeQuantity:P,maxTradeQuantity:U})}},[g.chain,g.decimals,Q,e,G,R,O,t,_,P,U,L,F,j]),ea=(0,N.useCallback)(()=>{if(!M)return;G.reset();let[a,r]=[g,e],o=j,i=I,s=t,l=n;if(!t.isZero()&&!j.isZero()){var u,c;(null===(c=G.result)||void 0===c?void 0:null===(u=c.arguments)||void 0===u?void 0:u.direction)==="sell"?(o=q.xE,i=""):(s=q.xE,l="")}B(a),R(r),F(i,a),O(l,r),Y.current="base"===Y.current?"quote":"base",D(a,r).length>0&&(s.isZero()?o.isZero()||G.fetch({baseToken:a,quoteToken:r,direction:"sell",amount:o,rfqType:S.C.RFQT,walletBalances:_,minTradeQuantity:P,maxTradeQuantity:U,minQuoteTradeQuantity:L}):G.fetch({baseToken:a,quoteToken:r,direction:"buy",amount:s,rfqType:S.C.RFQT,walletBalances:_,minTradeQuantity:P,maxTradeQuantity:U,minQuoteTradeQuantity:L}))},[M,G,g,e,j,I,t,n,B,R,F,O,D,_,P,U,L]),er=(0,N.useCallback)((t,n)=>{if(!M)throw Error("Cannot update the value without a wallet set.");G.reset();let r="string"==typeof n?n.replace(/,/g,""):n;F("base"===t?r:"",e),O("quote"===t?r:"",g),Y.current=t;let o=r instanceof a.Z?r:new a.Z(r).multipliedBy(new a.Z(10).pow(("base"===t?e:g).decimals));o.isGreaterThan(0)&&D(e,g).length>0&&((0,x.m)(e,g,J(e.chain),X(g.chain))?G.fetch({direction:"base"===t?"sell":"buy",baseToken:e,quoteToken:g,amount:o,rfqType:S.C.RFQT,walletBalances:_,minTradeQuantity:P,maxTradeQuantity:U,minQuoteTradeQuantity:L}):G.queueFetch({direction:"base"===t?"sell":"buy",baseToken:e,quoteToken:g,amount:o,rfqType:S.C.RFQT,walletBalances:_,minTradeQuantity:P,maxTradeQuantity:U,minQuoteTradeQuantity:L}))},[M,G,F,e,O,g,D,J,X,_,P,U,L]),eo=(0,N.useRef)(q.xE),ei=(0,N.useRef)({lastFetchedMs:0}),es=(0,b.Z)([e,$,null==M?void 0:M.chain,g,D]);(0,T.Y)((0,N.useCallback)(async()=>{try{let a=es.current.signal;if((0,x.b)(e,g)&&D(e,g).length>0){if(null==M?void 0:M.address){let r=M.address.toString(),o=Date.now();if(!(ei.current.baseChainType===e.chain.chainType&&ei.current.quoteChainType===g.chain.chainType)||o-ei.current.lastFetchedMs>1e3){var t,n;ei.current={baseChainType:e.chain.chainType,quoteChainType:g.chain.chainType,lastFetchedMs:o};let i=await v(e.chain,g.chain,r,(t=e.chain,n=g.chain,A.has(t.chainId)&&A.has(n.chainId)?C.XChainProtocol.WORMHOLE:C.XChainProtocol.LAYER_ZERO));(0,m.k)(a),eo.current=i}}}else eo.current=q.xE}catch(e){if(e instanceof m._)return;throw e}},[e,g,null==M?void 0:M.address,es,D]),1e4);let el=(0,N.useCallback)(()=>{var t;let n=J(e.chain),r=X(e.chain),o=null!==(t=_[(0,Z.Bf)(e)])&&void 0!==t?t:q.xE,i=o;if((0,Z.RZ)(e,n)){let t=(0,x.m)(e,g,n,r)?(0,w.hp)(e.chain):(0,x.b)(e,g)?(0,p.pt)(e.chain):(0,f.RP)(e.chain),s="evm"!==e.chain.chainType||(0,x.b)(e,g)?new a.Z(t):(K?(0,y.S1)(K)?K.maxFeePerGas:K.price:y.ce).multipliedBy(new a.Z(t)),l=o.minus(s).minus(eo.current);i=l.isNegative()?q.xE:l}er("base",i)},[e,g,K,er,_,J,X]),eu=(0,N.useCallback)(n=>{G.reset();let a=n?S.C.RFQM:S.C.RFQT,r="base"===Y.current?"quote":"base",o=D(e,g).length>0;"base"===r?(F("",e),o&&!j.isZero()&&G.fetch({baseToken:e,quoteToken:g,direction:"buy",amount:j,rfqType:a,walletBalances:_,minTradeQuantity:P,maxTradeQuantity:U,minQuoteTradeQuantity:L})):(O("",g),o&&!t.isZero()&&G.fetch({baseToken:e,quoteToken:g,direction:"sell",amount:t,rfqType:a,walletBalances:_,minTradeQuantity:P,minQuoteTradeQuantity:L,maxTradeQuantity:U}))},[G,D,e,g,F,j,_,P,U,L,O,t]);return(0,N.useMemo)(()=>({setBaseToken:ee,setQuoteToken:et,setQuoteNetwork:en,swapTokens:ea,updateAmount:er,updateBaseAmountToMax:el,setGaslessTradingEnabled:eu}),[ee,en,et,ea,er,el,eu])}}}]);